document.write('<link rel="stylesheet" href="../arduino/style/githubEmbed.css"/>');document.write('<link rel="stylesheet" href="../arduino/style/githubEmbed.css"/>');/*
---
script: Fx.Scroll.js
name: Fx.Scroll
description: Effect to smoothly scroll any element, including the window.
license: MIT-style license
authors:
  - Valerio Proietti
requires:
  - Core/Fx
  - Core/Element.Event
  - Core/Element.Dimensions
  - MooTools.More
provides: [Fx.Scroll]
...
*/

function GHE_isBody(element){
	return (/^(?:body|html)$/i).test(element.tagName);
}

Fx.Scroll = new Class({
	Extends: Fx,
	options: {
		offset: {x: 0, y: 0},
		wheelStops: true
	},
	initialize: function(element, options){
		this.element = this.subject = document.id(element);
		this.parent(options);
		if (typeOf(this.element) != 'element') this.element = document.id(this.element.getDocument().body);
		if (this.options.wheelStops){
			var stopper = this.element,
				cancel = this.cancel.pass(false, this);
			this.addEvent('start', function(){
				stopper.addEvent('mousewheel', cancel);
			}, true);
			this.addEvent('complete', function(){
				stopper.removeEvent('mousewheel', cancel);
			}, true);
		}
	},
	set: function(){
		var now = Array.flatten(arguments);
		if (Browser.firefox) now = [Math.round(now[0]), Math.round(now[1])]; // not needed anymore in newer firefox versions
		this.element.scrollTo(now[0], now[1]);
		return this;
	},
	compute: function(from, to, delta){
		return [0, 1].map(function(i){
			return Fx.compute(from[i], to[i], delta);
		});
	},
	start: function(x, y){
		if (!this.check(x, y)) return this;
		var scroll = this.element.getScroll();
		return this.parent([scroll.x, scroll.y], [x, y]);
	},
	calculateScroll: function(x, y){
		var element = this.element,
			scrollSize = element.getScrollSize(),
			scroll = element.getScroll(),
			size = element.getSize(),
			offset = this.options.offset,
			values = {x: x, y: y};
		for (var z in values){
			if (!values[z] && values[z] !== 0) values[z] = scroll[z];
			if (typeOf(values[z]) != 'number') values[z] = scrollSize[z] - size[z];
			values[z] += offset[z];
		}
		return [values.x, values.y];
	},
	toElement: function(el, axes){
		axes = axes ? Array.from(axes) : ['x', 'y'];
		var scroll = GHE_isBody(this.element) ? {x: 0, y: 0} : this.element.getScroll();
		var position = Object.map(document.id(el).getPosition(this.element), function(value, axis){
			return axes.contains(axis) ? value + scroll[axis] : false;
		});
		return this.start.apply(this, this.calculateScroll(position.x, position.y));
	}
});

var Embed = new Class({
	Implements: [Events],
	initialize: function(wrapper, codeWrapper, data){

		this.wrapper = document.id(wrapper);
		this.codeWrapper = document.id(codeWrapper);
		this.data = data;
		this.codeScroll = new Fx.Scroll(this.codeWrapper, {link: 'cancel'});
		this.files = [];
		this.rawTree = [];
		for (var i = 0; i < data.tree.length; i++) {
			var file = {};
			file.path = this.getPath(this.data.tree[i].path);
			file.mode = this.data.tree[i].mode;
			file.sha = this.data.tree[i].sha;
			file.url = this.data.tree[i].url;
			file.name = file.path.pop();
			file.extension = file.name.split('.').pop();
			file.type = (this.data.tree[i].type == "tree")? 'folder' : 'file';
			this.rawTree.push(file);
		}
		this.filelist = new GHE_Filelist(this.wrapper);
		//loop through files, and make structure.
		for (var i = 0; i < this.rawTree.length; i++) {
			var file = this.rawTree[i];
			var path = this.filelist;
			//find/create file path
			while(file.path.length > 0){
				var segment = file.path.shift();
				if(!path[segment]){
					path[segment] =  new GHE_Folder(path.fileHousing, file, segment);
				}
				path = path[segment];
			}
			if(file.type == 'file'){
				if(file.extension != 'gitignore' && file.extension != 'pdf'){
					path[file.name] = new GHE_File(path.fileHousing,file);
					path[file.name].addEvent('clicked', this.fileClicked.bind(this));
					this.files.push(path[file.name]);
				}
			}else{
				path[file.name] = new GHE_Folder(path.fileHousing,file);
			}
		}
		this.files[0].select();
		console.log(this.fileList);
	},
	fileClicked: function(file){
		for (var i = 0; i < this.files.length; i++) {
			this.files[i].unselect();
		}
		file.select();
		console.log(file);
		this.codeScroll.toElement(document.id(file.sha));
	},
	getPath: function(path){
		return path.split("/");
	}
});var GHE_Filelist = new Class({
	Implements: [Events],
	initialize: function(wrapper){
		this.wrapper = document.id(wrapper);
		
		this.buildUI();
	},
	buildUI: function(){
		this.body = new Element('div', {'class': 'fileList'}).inject(this.wrapper);
			this.fileHousing = new Element('div', {'class': 'fileHousing'}).inject(this.body);
		//console.log(this);
	},
});
var GHE_File = new Class({
	Implements: [Events],
	initialize: function(wrapper, data){
		this.data = data;
		this.name = data.name;
		this.sha = data.sha;
		this.url = data.url;
		this.mode = data.mode;
		this.wrapper = document.id(wrapper);
		this.buildUI();
	},
	buildUI: function(){
		this.body = new Element('div', {'class': 'file'}).inject(this.wrapper);
			this.nameEl = new Element('div', {'class': 'name', html: this.data.name}).inject(this.body);
		this.body.addEvent('click', this.clicked.bind(this));
	},
	clicked: function(){
		this.fireEvent('clicked', this);
	},
	select: function(){
		this.body.addClass('selected');
	},
	unselect: function(){
		this.body.removeClass('selected');
	}
});var GHE_Folder = new Class({
	Implements: [Events],
	initialize: function(wrapper, data, name){
		this.data = data;
		this.name = name;
		this.sha = data.sha;
		this.url = data.url;
		this.mode = data.mode;
		this.wrapper = document.id(wrapper);
		
		this.buildUI();
	},
	buildUI: function(){
		this.folderWrapper = new Element('div', {'class': 'folderWrapper'}).inject(this.wrapper);
			this.body = new Element('div', {'class': 'folder'}).inject(this.folderWrapper);
				this.nameEl = new Element('div', {'class': 'name', html: this.name}).inject(this.body);
			this.fileHousing = new Element('div', {'class': 'fileHousing'}).inject(this.folderWrapper);
		this.body.addEvent('click', this.clicked.bind(this));
	},
	clicked: function(){
		this.fireEvent('clicked', this);
	},
	addFile: function(file){
		this.fileHousing.inject(file.body);
	}
});
document.write('<div class=\"githubEmbed_projectWrapper\"><div class=\"projectHeader\" ><span class=\"projectTitle\"><a title=\"github.com: ameyer/GPS-EM-406A\" href=\"http://github.com/ameyer/GPS-EM-406A\">GPS-EM-406A</a> </span><a class=\"downloadButton\" title=\"download prject from github\" href=\"https://github.com/ameyer/GPS-EM-406A/archive/master.zip\">download</a></div><div class=\"body\"><div class=\"sideBar\" id=\"GPS-EM-406A_sidebar\"></div><div class=\"projectCode\" id=\"GPS-EM-406A_code\">   <div class=\"fileWrapper txt\" id=\"b132efea8543fe82d1fd16a19298a9840f395e17\">  <p class=\"fileHead\">License.txt</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code>Copyright (c) 2010 bildr community<br /><br />Permission is hereby granted, free of charge, to any person obtaining a copy<br />of this software and associated documentation files (the &quot;Software&quot;), to deal<br />in the Software without restriction, including without limitation the rights<br />to use, copy, modify, merge, publish, distribute, sublicense, and/or sell<br />copies of the Software, and to permit persons to whom the Software is<br />furnished to do so, subject to the following conditions:<br /><br />The above copyright notice and this permission notice shall be included in<br />all copies or substantial portions of the Software.<br /><br />THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR<br />IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,<br />FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE<br />AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER<br />LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,<br />OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN<br />THE SOFTWARE.</code></pre>  </div>  </div>  </div>      <div class=\"fileWrapper md\" id=\"f858d36c6a28ae17f9e58ce8cc97cbe23b552679\">  <p class=\"fileHead\">README.md</p>    <div class=\"fileCodeWrapper\">    <div class=\"code\">  <div class=\"markdown\"><h1>EM-406A GPS Module</h1><p>Arduino code for the EM-406A GPS Module</p><p>For complete hookup and tutorial see: <a href=\"http://adam-meyer.com/arduino/em-406a\">http://adam-meyer.com/arduino/em-406a</a></p><p>The code is provided under the MIT license please use, edit, change, and share. </p><p><em>Before loading the example code, or even opening the arduino software, place the TinyGPS10 folder in your arduino library.</em></p><h5>ARDUINO LIBRARY LOCATION</h5><ul><li>On your Mac:: In (home directory)/Documents/Arduino/libraries  </li><li>On your PC:: My Documents -&gt; Arduino -&gt; libraries  </li><li>On your Linux box: (home directory)/sketchbook/libraries  </li></ul><p>For all my arduino articles: <a href=\"http://adam-meyer.com/arduino/\">http://adam-meyer.com/arduino/</a></p></div>  </div>  </div>  </div>      <div class=\"fileWrapper cpp\" id=\"06a17207a19ff52b4d6535863c1d702bb5844847\">  <p class=\"fileHead\">TinyGPS.cpp</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />69<br />70<br />71<br />72<br />73<br />74<br />75<br />76<br />77<br />78<br />79<br />80<br />81<br />82<br />83<br />84<br />85<br />86<br />87<br />88<br />89<br />90<br />91<br />92<br />93<br />94<br />95<br />96<br />97<br />98<br />99<br />100<br />101<br />102<br />103<br />104<br />105<br />106<br />107<br />108<br />109<br />110<br />111<br />112<br />113<br />114<br />115<br />116<br />117<br />118<br />119<br />120<br />121<br />122<br />123<br />124<br />125<br />126<br />127<br />128<br />129<br />130<br />131<br />132<br />133<br />134<br />135<br />136<br />137<br />138<br />139<br />140<br />141<br />142<br />143<br />144<br />145<br />146<br />147<br />148<br />149<br />150<br />151<br />152<br />153<br />154<br />155<br />156<br />157<br />158<br />159<br />160<br />161<br />162<br />163<br />164<br />165<br />166<br />167<br />168<br />169<br />170<br />171<br />172<br />173<br />174<br />175<br />176<br />177<br />178<br />179<br />180<br />181<br />182<br />183<br />184<br />185<br />186<br />187<br />188<br />189<br />190<br />191<br />192<br />193<br />194<br />195<br />196<br />197<br />198<br />199<br />200<br />201<br />202<br />203<br />204<br />205<br />206<br />207<br />208<br />209<br />210<br />211<br />212<br />213<br />214<br />215<br />216<br />217<br />218<br />219<br />220<br />221<br />222<br />223<br />224<br />225<br />226<br />227<br />228<br />229<br />230<br />231<br />232<br />233<br />234<br />235<br />236<br />237<br />238<br />239<br />240<br />241<br />242<br />243<br />244<br />245<br />246<br />247<br />248<br />249<br />250<br />251<br />252<br />253<br />254<br />255<br />256<br />257<br />258<br />259<br />260<br />261<br />262<br />263<br />264<br />265<br />266<br />267<br />268<br />269<br />270<br />271<br />272<br />273<br />274<br />275<br />276<br />277<br />278<br />279<br />280<br />281<br />282<br />283<br />284<br />285<br />286<br />287<br />288<br />289<br />290<br />291<br />292<br />293<br />294<br />295<br />296<br />297<br />298<br />299<br />300<br />301<br />302<br />303<br />304<br />305<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code><span class=\"coMULTI\">/*<br /> TinyGPS - a small GPS library for Arduino providing basic NMEA parsing<br /> Based on work by and &quot;distance_to&quot; courtesy of Maarten Lamers.<br /> Copyright (C) 2008-2011 Mikal Hart<br /> All rights reserved.<br /><br /> This library is free software; you can redistribute it and/or<br /> modify it under the terms of the GNU Lesser General Public<br /> License as published by the Free Software Foundation; either<br /> version 2.1 of the License, or (at your option) any later version.<br /><br /> This library is distributed in the hope that it will be useful,<br /> but WITHOUT ANY WARRANTY; without even the implied warranty of<br /> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU<br /> Lesser General Public License for more details.<br /><br /> You should have received a copy of the GNU Lesser General Public<br /> License along with this library; if not, write to the Free Software<br /> Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA<br />*/</span><br /><br /><span class=\"co2\">#include &quot;Arduino.h&quot;</span><br /><span class=\"co2\">#include &quot;TinyGPS.h&quot;</span><br /><br /><span class=\"co2\">#define _GPRMC_TERM  &quot;GPRMC&quot;</span><br /><span class=\"co2\">#define _GPGGA_TERM  &quot;GPGGA&quot;</span><br /><br />TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">TinyGPS</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"sy0\">:</span> _time<span class=\"br0\">&#40;</span>GPS_INVALID_TIME<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _date<span class=\"br0\">&#40;</span>GPS_INVALID_DATE<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _latitude<span class=\"br0\">&#40;</span>GPS_INVALID_ANGLE<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _longitude<span class=\"br0\">&#40;</span>GPS_INVALID_ANGLE<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _altitude<span class=\"br0\">&#40;</span>GPS_INVALID_ALTITUDE<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _speed<span class=\"br0\">&#40;</span>GPS_INVALID_SPEED<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _course<span class=\"br0\">&#40;</span>GPS_INVALID_ANGLE<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _last_time_fix<span class=\"br0\">&#40;</span>GPS_INVALID_FIX_TIME<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _last_position_fix<span class=\"br0\">&#40;</span>GPS_INVALID_FIX_TIME<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _parity<span class=\"br0\">&#40;</span>0<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _is_checksum_term<span class=\"br0\">&#40;</span><span class=\"kw2\">false</span><span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _sentence_type<span class=\"br0\">&#40;</span>_GPS_SENTENCE_OTHER<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _term_number<span class=\"br0\">&#40;</span>0<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _term_offset<span class=\"br0\">&#40;</span>0<span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _gps_data_good<span class=\"br0\">&#40;</span><span class=\"kw2\">false</span><span class=\"br0\">&#41;</span><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br /><span class=\"sy0\">,</span> _encoded_characters<span class=\"br0\">&#40;</span><span class=\"nu0\">0</span><span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _good_sentences<span class=\"br0\">&#40;</span><span class=\"nu0\">0</span><span class=\"br0\">&#41;</span><br /><span class=\"sy0\">,</span> _failed_checksum<span class=\"br0\">&#40;</span><span class=\"nu0\">0</span><span class=\"br0\">&#41;</span><br /><span class=\"co2\">#endif</span><br /><span class=\"br0\">&#123;</span><br /> _term<span class=\"br0\">&#91;</span><span class=\"nu0\">0</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">=</span> <span class=\"st0\">\'<span class=\"es5\">\\0</span>\'</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"co1\">//</span><br /><span class=\"co1\">// public methods</span><br /><span class=\"co1\">//</span><br /><br />bool TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">encode</span><span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> c<span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> bool valid_sentence <span class=\"sy0\">=</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br /><br /> <span class=\"sy0\">++</span>_encoded_characters<span class=\"sy0\">;</span><br /> <span class=\"kw1\">switch</span><span class=\"br0\">&#40;</span>c<span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">case</span> <span class=\"st0\">\',\'</span><span class=\"sy0\">:</span> <span class=\"co1\">// term terminators</span><br />  _parity <span class=\"sy0\">^=</span> c<span class=\"sy0\">;</span><br /> <span class=\"kw1\">case</span> <span class=\"st0\">\'<span class=\"es1\">\\r</span>\'</span><span class=\"sy0\">:</span><br /> <span class=\"kw1\">case</span> <span class=\"st0\">\'<span class=\"es1\">\\n</span>\'</span><span class=\"sy0\">:</span><br /> <span class=\"kw1\">case</span> <span class=\"st0\">\'*\'</span><span class=\"sy0\">:</span><br />  <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_term_offset <span class=\"sy0\">&lt;</span> <span class=\"kw4\">sizeof</span><span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   _term<span class=\"br0\">&#91;</span>_term_offset<span class=\"br0\">&#93;</span> <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br />   valid_sentence <span class=\"sy0\">=</span> term_complete<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br />  <span class=\"sy0\">++</span>_term_number<span class=\"sy0\">;</span><br />  _term_offset <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br />  _is_checksum_term <span class=\"sy0\">=</span> c <span class=\"sy0\">==</span> <span class=\"st0\">\'*\'</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">return</span> valid_sentence<span class=\"sy0\">;</span><br /><br /> <span class=\"kw1\">case</span> <span class=\"st0\">\'$\'</span><span class=\"sy0\">:</span> <span class=\"co1\">// sentence begin</span><br />  _term_number <span class=\"sy0\">=</span> _term_offset <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br />  _parity <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br />  _sentence_type <span class=\"sy0\">=</span> _GPS_SENTENCE_OTHER<span class=\"sy0\">;</span><br />  _is_checksum_term <span class=\"sy0\">=</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br />  _gps_data_good <span class=\"sy0\">=</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">return</span> valid_sentence<span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span><br /><br /> <span class=\"co1\">// ordinary characters</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_term_offset <span class=\"sy0\">&lt;</span> <span class=\"kw4\">sizeof</span><span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#41;</span> <span class=\"sy0\">-</span> 1<span class=\"br0\">&#41;</span><br />  _term<span class=\"br0\">&#91;</span>_term_offset<span class=\"sy0\">++</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">=</span> c<span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">!</span>_is_checksum_term<span class=\"br0\">&#41;</span><br />  _parity <span class=\"sy0\">^=</span> c<span class=\"sy0\">;</span><br /><br /> <span class=\"kw1\">return</span> valid_sentence<span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br /><span class=\"kw4\">void</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">stats</span><span class=\"br0\">&#40;</span><span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>chars<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> <span class=\"sy0\">*</span>sentences<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> <span class=\"sy0\">*</span>failed_cs<span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>chars<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>chars <span class=\"sy0\">=</span> _encoded_characters<span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>sentences<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>sentences <span class=\"sy0\">=</span> _good_sentences<span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>failed_cs<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>failed_cs <span class=\"sy0\">=</span> _failed_checksum<span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><span class=\"co2\">#endif</span><br /><br /><span class=\"co1\">//</span><br /><span class=\"co1\">// internal utilities</span><br /><span class=\"co1\">//</span><br /><span class=\"kw4\">int</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">from_hex</span><span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> a<span class=\"br0\">&#41;</span> <br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>a <span class=\"sy0\">&gt;=</span> <span class=\"st0\">\'A\'</span> <span class=\"sy0\">&amp;&amp;</span> a <span class=\"sy0\">&lt;=</span> <span class=\"st0\">\'F\'</span><span class=\"br0\">&#41;</span><br />  <span class=\"kw1\">return</span> a <span class=\"sy0\">-</span> <span class=\"st0\">\'A\'</span> <span class=\"sy0\">+</span> <span class=\"nu0\">10</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">else</span> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>a <span class=\"sy0\">&gt;=</span> <span class=\"st0\">\'a\'</span> <span class=\"sy0\">&amp;&amp;</span> a <span class=\"sy0\">&lt;=</span> <span class=\"st0\">\'f\'</span><span class=\"br0\">&#41;</span><br />  <span class=\"kw1\">return</span> a <span class=\"sy0\">-</span> <span class=\"st0\">\'a\'</span> <span class=\"sy0\">+</span> <span class=\"nu0\">10</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">else</span><br />  <span class=\"kw1\">return</span> a <span class=\"sy0\">-</span> <span class=\"st0\">\'0\'</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">parse_decimal</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>p <span class=\"sy0\">=</span> _term<span class=\"sy0\">;</span><br /> bool isneg <span class=\"sy0\">=</span> <span class=\"sy0\">*</span>p <span class=\"sy0\">==</span> <span class=\"st0\">\'-\'</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>isneg<span class=\"br0\">&#41;</span> <span class=\"sy0\">++</span>p<span class=\"sy0\">;</span><br /> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> ret <span class=\"sy0\">=</span> 100UL <span class=\"sy0\">*</span> gpsatol<span class=\"br0\">&#40;</span>p<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">while</span> <span class=\"br0\">&#40;</span>gpsisdigit<span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>p<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">++</span>p<span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>p <span class=\"sy0\">==</span> <span class=\"st0\">\'.\'</span><span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>gpsisdigit<span class=\"br0\">&#40;</span>p<span class=\"br0\">&#91;</span><span class=\"nu0\">1</span><span class=\"br0\">&#93;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   ret <span class=\"sy0\">+=</span> <span class=\"nu0\">10</span> <span class=\"sy0\">*</span> <span class=\"br0\">&#40;</span>p<span class=\"br0\">&#91;</span><span class=\"nu0\">1</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">-</span> <span class=\"st0\">\'0\'</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>gpsisdigit<span class=\"br0\">&#40;</span>p<span class=\"br0\">&#91;</span><span class=\"nu0\">2</span><span class=\"br0\">&#93;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />    ret <span class=\"sy0\">+=</span> p<span class=\"br0\">&#91;</span><span class=\"nu0\">2</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">-</span> <span class=\"st0\">\'0\'</span><span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /> <span class=\"br0\">&#125;</span><br /> <span class=\"kw1\">return</span> isneg <span class=\"sy0\">?</span> <span class=\"sy0\">-</span>ret <span class=\"sy0\">:</span> ret<span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">parse_degrees</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>p<span class=\"sy0\">;</span><br /> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> left <span class=\"sy0\">=</span> gpsatol<span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> tenk_minutes <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>left <span class=\"sy0\">%</span> 100UL<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span> 10000UL<span class=\"sy0\">;</span><br /> <span class=\"kw1\">for</span> <span class=\"br0\">&#40;</span>p<span class=\"sy0\">=</span>_term<span class=\"sy0\">;</span> gpsisdigit<span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>p<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"sy0\">++</span>p<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>p <span class=\"sy0\">==</span> <span class=\"st0\">\'.\'</span><span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> mult <span class=\"sy0\">=</span> <span class=\"nu0\">1000</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">while</span> <span class=\"br0\">&#40;</span>gpsisdigit<span class=\"br0\">&#40;</span><span class=\"sy0\">*++</span>p<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   tenk_minutes <span class=\"sy0\">+=</span> mult <span class=\"sy0\">*</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>p <span class=\"sy0\">-</span> <span class=\"st0\">\'0\'</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   mult <span class=\"sy0\">/=</span> <span class=\"nu0\">10</span><span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /> <span class=\"br0\">&#125;</span><br /> <span class=\"kw1\">return</span> <span class=\"br0\">&#40;</span>left <span class=\"sy0\">/</span> 100<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span> 100000 <span class=\"sy0\">+</span> tenk_minutes <span class=\"sy0\">/</span> <span class=\"nu0\">6</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"co1\">// Processes a just-completed term</span><br /><span class=\"co1\">// Returns true if new sentence has just passed checksum test and is validated</span><br />bool TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">term_complete</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_is_checksum_term<span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br />  byte checksum <span class=\"sy0\">=</span> 16 <span class=\"sy0\">*</span> from_hex<span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#91;</span>0<span class=\"br0\">&#93;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">+</span> from_hex<span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#91;</span>1<span class=\"br0\">&#93;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>checksum <span class=\"sy0\">==</span> _parity<span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_gps_data_good<span class=\"br0\">&#41;</span><br />   <span class=\"br0\">&#123;</span><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br />    <span class=\"sy0\">++</span>_good_sentences<span class=\"sy0\">;</span><br /><span class=\"co2\">#endif</span><br />    _last_time_fix <span class=\"sy0\">=</span> _new_time_fix<span class=\"sy0\">;</span><br />    _last_position_fix <span class=\"sy0\">=</span> _new_position_fix<span class=\"sy0\">;</span><br /><br />    <span class=\"kw1\">switch</span><span class=\"br0\">&#40;</span>_sentence_type<span class=\"br0\">&#41;</span><br />    <span class=\"br0\">&#123;</span><br />    <span class=\"kw1\">case</span> _GPS_SENTENCE_GPRMC<span class=\"sy0\">:</span><br />     _time   <span class=\"sy0\">=</span> _new_time<span class=\"sy0\">;</span><br />     _date   <span class=\"sy0\">=</span> _new_date<span class=\"sy0\">;</span><br />     _latitude <span class=\"sy0\">=</span> _new_latitude<span class=\"sy0\">;</span><br />     _longitude <span class=\"sy0\">=</span> _new_longitude<span class=\"sy0\">;</span><br />     _speed   <span class=\"sy0\">=</span> _new_speed<span class=\"sy0\">;</span><br />     _course  <span class=\"sy0\">=</span> _new_course<span class=\"sy0\">;</span><br />     <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />    <span class=\"kw1\">case</span> _GPS_SENTENCE_GPGGA<span class=\"sy0\">:</span><br />     _altitude <span class=\"sy0\">=</span> _new_altitude<span class=\"sy0\">;</span><br />     _time   <span class=\"sy0\">=</span> _new_time<span class=\"sy0\">;</span><br />     _latitude <span class=\"sy0\">=</span> _new_latitude<span class=\"sy0\">;</span><br />     _longitude <span class=\"sy0\">=</span> _new_longitude<span class=\"sy0\">;</span><br />     <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />    <span class=\"br0\">&#125;</span><br /><br />    <span class=\"kw1\">return</span> <span class=\"kw2\">true</span><span class=\"sy0\">;</span><br />   <span class=\"br0\">&#125;</span><br />  <span class=\"br0\">&#125;</span><br /><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br />  <span class=\"kw1\">else</span><br />   <span class=\"sy0\">++</span>_failed_checksum<span class=\"sy0\">;</span><br /><span class=\"co2\">#endif</span><br />  <span class=\"kw1\">return</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span><br /><br /> <span class=\"co1\">// the first term determines the sentence type</span><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_term_number <span class=\"sy0\">==</span> 0<span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">!</span>gpsstrcmp<span class=\"br0\">&#40;</span>_term<span class=\"sy0\">,</span> _GPRMC_TERM<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />   _sentence_type <span class=\"sy0\">=</span> _GPS_SENTENCE_GPRMC<span class=\"sy0\">;</span><br />  <span class=\"kw1\">else</span> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">!</span>gpsstrcmp<span class=\"br0\">&#40;</span>_term<span class=\"sy0\">,</span> _GPGGA_TERM<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />   _sentence_type <span class=\"sy0\">=</span> _GPS_SENTENCE_GPGGA<span class=\"sy0\">;</span><br />  <span class=\"kw1\">else</span><br />   _sentence_type <span class=\"sy0\">=</span> _GPS_SENTENCE_OTHER<span class=\"sy0\">;</span><br />  <span class=\"kw1\">return</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span><br /><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_sentence_type <span class=\"sy0\">!=</span> _GPS_SENTENCE_OTHER <span class=\"sy0\">&amp;&amp;</span> _term<span class=\"br0\">&#91;</span>0<span class=\"br0\">&#93;</span><span class=\"br0\">&#41;</span><br /> <span class=\"kw1\">switch</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#40;</span>_sentence_type <span class=\"sy0\">==</span> _GPS_SENTENCE_GPGGA <span class=\"sy0\">?</span> 200 <span class=\"sy0\">:</span> 100<span class=\"br0\">&#41;</span> <span class=\"sy0\">+</span> _term_number<span class=\"br0\">&#41;</span><br /> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">101</span><span class=\"sy0\">:</span> <span class=\"co1\">// Time in both sentences</span><br />  <span class=\"kw1\">case</span> 201<span class=\"sy0\">:</span><br />   _new_time <span class=\"sy0\">=</span> parse_decimal<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   _new_time_fix <span class=\"sy0\">=</span> millis<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">102</span><span class=\"sy0\">:</span> <span class=\"co1\">// GPRMC validity</span><br />   _gps_data_good <span class=\"sy0\">=</span> _term<span class=\"br0\">&#91;</span><span class=\"nu0\">0</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">==</span> <span class=\"st0\">\'A\'</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">103</span><span class=\"sy0\">:</span> <span class=\"co1\">// Latitude</span><br />  <span class=\"kw1\">case</span> 202<span class=\"sy0\">:</span><br />   _new_latitude <span class=\"sy0\">=</span> parse_degrees<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   _new_position_fix <span class=\"sy0\">=</span> millis<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">104</span><span class=\"sy0\">:</span> <span class=\"co1\">// N/S</span><br />  <span class=\"kw1\">case</span> 203<span class=\"sy0\">:</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#91;</span><span class=\"nu0\">0</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">==</span> <span class=\"st0\">\'S\'</span><span class=\"br0\">&#41;</span><br />    _new_latitude <span class=\"sy0\">=</span> <span class=\"sy0\">-</span>_new_latitude<span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">105</span><span class=\"sy0\">:</span> <span class=\"co1\">// Longitude</span><br />  <span class=\"kw1\">case</span> 204<span class=\"sy0\">:</span><br />   _new_longitude <span class=\"sy0\">=</span> parse_degrees<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">106</span><span class=\"sy0\">:</span> <span class=\"co1\">// E/W</span><br />  <span class=\"kw1\">case</span> 205<span class=\"sy0\">:</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#91;</span><span class=\"nu0\">0</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">==</span> <span class=\"st0\">\'W\'</span><span class=\"br0\">&#41;</span><br />    _new_longitude <span class=\"sy0\">=</span> <span class=\"sy0\">-</span>_new_longitude<span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">107</span><span class=\"sy0\">:</span> <span class=\"co1\">// Speed (GPRMC)</span><br />   _new_speed <span class=\"sy0\">=</span> parse_decimal<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">108</span><span class=\"sy0\">:</span> <span class=\"co1\">// Course (GPRMC)</span><br />   _new_course <span class=\"sy0\">=</span> parse_decimal<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">109</span><span class=\"sy0\">:</span> <span class=\"co1\">// Date (GPRMC)</span><br />   _new_date <span class=\"sy0\">=</span> gpsatol<span class=\"br0\">&#40;</span>_term<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">206</span><span class=\"sy0\">:</span> <span class=\"co1\">// Fix data (GPGGA)</span><br />   _gps_data_good <span class=\"sy0\">=</span> _term<span class=\"br0\">&#91;</span><span class=\"nu0\">0</span><span class=\"br0\">&#93;</span> <span class=\"sy0\">&gt;</span> <span class=\"st0\">\'0\'</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br />  <span class=\"kw1\">case</span> <span class=\"nu0\">209</span><span class=\"sy0\">:</span> <span class=\"co1\">// Altitude (GPGGA)</span><br />   _new_altitude <span class=\"sy0\">=</span> parse_decimal<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw2\">break</span><span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span><br /><br /> <span class=\"kw1\">return</span> <span class=\"kw2\">false</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">long</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">gpsatol</span><span class=\"br0\">&#40;</span><span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str<span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw4\">long</span> ret <span class=\"sy0\">=</span> <span class=\"nu0\">0</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">while</span> <span class=\"br0\">&#40;</span>gpsisdigit<span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>str<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><br />  ret <span class=\"sy0\">=</span> <span class=\"nu0\">10</span> <span class=\"sy0\">*</span> ret <span class=\"sy0\">+</span> <span class=\"sy0\">*</span>str<span class=\"sy0\">++</span> <span class=\"sy0\">-</span> <span class=\"st0\">\'0\'</span><span class=\"sy0\">;</span><br /> <span class=\"kw1\">return</span> ret<span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">int</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">gpsstrcmp</span><span class=\"br0\">&#40;</span><span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str1<span class=\"sy0\">,</span> <span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str2<span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">while</span> <span class=\"br0\">&#40;</span><span class=\"sy0\">*</span>str1 <span class=\"sy0\">&amp;&amp;</span> <span class=\"sy0\">*</span>str1 <span class=\"sy0\">==</span> <span class=\"sy0\">*</span>str2<span class=\"br0\">&#41;</span><br />  <span class=\"sy0\">++</span>str1<span class=\"sy0\">,</span> <span class=\"sy0\">++</span>str2<span class=\"sy0\">;</span><br /> <span class=\"kw1\">return</span> <span class=\"sy0\">*</span>str1<span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"coMULTI\">/* static */</span><br /><span class=\"kw4\">float</span> TinyGPS<span class=\"sy0\">::</span><span class=\"me2\">distance_between</span> <span class=\"br0\">&#40;</span><span class=\"kw4\">float</span> lat1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> long1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> lat2<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> long2<span class=\"br0\">&#41;</span> <br /><span class=\"br0\">&#123;</span><br /> <span class=\"co1\">// returns distance in meters between two positions, both specified </span><br /> <span class=\"co1\">// as signed decimal-degrees latitude and longitude. Uses great-circle </span><br /> <span class=\"co1\">// distance computation for hypothetical sphere of radius 6372795 meters.</span><br /> <span class=\"co1\">// Because Earth is no exact sphere, rounding errors may be up to 0.5%.</span><br /> <span class=\"co1\">// Courtesy of Maarten Lamers</span><br /> <span class=\"kw4\">float</span> delta <span class=\"sy0\">=</span> radians<span class=\"br0\">&#40;</span>long1<span class=\"sy0\">-</span>long2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> sdlong <span class=\"sy0\">=</span> sin<span class=\"br0\">&#40;</span>delta<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> cdlong <span class=\"sy0\">=</span> cos<span class=\"br0\">&#40;</span>delta<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> lat1 <span class=\"sy0\">=</span> radians<span class=\"br0\">&#40;</span>lat1<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> lat2 <span class=\"sy0\">=</span> radians<span class=\"br0\">&#40;</span>lat2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> slat1 <span class=\"sy0\">=</span> sin<span class=\"br0\">&#40;</span>lat1<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> clat1 <span class=\"sy0\">=</span> cos<span class=\"br0\">&#40;</span>lat1<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> slat2 <span class=\"sy0\">=</span> sin<span class=\"br0\">&#40;</span>lat2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"kw4\">float</span> clat2 <span class=\"sy0\">=</span> cos<span class=\"br0\">&#40;</span>lat2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> delta <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>clat1 <span class=\"sy0\">*</span> slat2<span class=\"br0\">&#41;</span> <span class=\"sy0\">-</span> <span class=\"br0\">&#40;</span>slat1 <span class=\"sy0\">*</span> clat2 <span class=\"sy0\">*</span> cdlong<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> delta <span class=\"sy0\">=</span> sq<span class=\"br0\">&#40;</span>delta<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> delta <span class=\"sy0\">+=</span> sq<span class=\"br0\">&#40;</span>clat2 <span class=\"sy0\">*</span> sdlong<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> delta <span class=\"sy0\">=</span> sqrt<span class=\"br0\">&#40;</span>delta<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <span class=\"kw4\">float</span> denom <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>slat1 <span class=\"sy0\">*</span> slat2<span class=\"br0\">&#41;</span> <span class=\"sy0\">+</span> <span class=\"br0\">&#40;</span>clat1 <span class=\"sy0\">*</span> clat2 <span class=\"sy0\">*</span> cdlong<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> delta <span class=\"sy0\">=</span> atan2<span class=\"br0\">&#40;</span>delta<span class=\"sy0\">,</span> denom<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <span class=\"kw1\">return</span> delta <span class=\"sy0\">*</span> <span class=\"nu0\">6372795</span><span class=\"sy0\">;</span> <br /><span class=\"br0\">&#125;</span><br /></code></pre>  </div>  </div>  </div>      <div class=\"fileWrapper h\" id=\"71ca21f8e5acbf7d17bf14013936b8f89c12c65e\">  <p class=\"fileHead\">TinyGPS.h</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />69<br />70<br />71<br />72<br />73<br />74<br />75<br />76<br />77<br />78<br />79<br />80<br />81<br />82<br />83<br />84<br />85<br />86<br />87<br />88<br />89<br />90<br />91<br />92<br />93<br />94<br />95<br />96<br />97<br />98<br />99<br />100<br />101<br />102<br />103<br />104<br />105<br />106<br />107<br />108<br />109<br />110<br />111<br />112<br />113<br />114<br />115<br />116<br />117<br />118<br />119<br />120<br />121<br />122<br />123<br />124<br />125<br />126<br />127<br />128<br />129<br />130<br />131<br />132<br />133<br />134<br />135<br />136<br />137<br />138<br />139<br />140<br />141<br />142<br />143<br />144<br />145<br />146<br />147<br />148<br />149<br />150<br />151<br />152<br />153<br />154<br />155<br />156<br />157<br />158<br />159<br />160<br />161<br />162<br />163<br />164<br />165<br />166<br />167<br />168<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code><br /><span class=\"coMULTI\">/*<br /> TinyGPS - a small GPS library for Arduino providing basic NMEA parsing<br /> Based on work by and &quot;distance_to&quot; courtesy of Maarten Lamers.<br /> Copyright (C) 2008-2011 Mikal Hart<br /> All rights reserved.<br /><br /> This library is free software; you can redistribute it and/or<br /> modify it under the terms of the GNU Lesser General Public<br /> License as published by the Free Software Foundation; either<br /> version 2.1 of the License, or (at your option) any later version.<br /><br /> This library is distributed in the hope that it will be useful,<br /> but WITHOUT ANY WARRANTY; without even the implied warranty of<br /> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU<br /> Lesser General Public License for more details.<br /><br /> You should have received a copy of the GNU Lesser General Public<br /> License along with this library; if not, write to the Free Software<br /> Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA<br />*/</span><br /><br /><span class=\"co2\">#ifndef TinyGPS_h</span><br /><span class=\"co2\">#define TinyGPS_h</span><br /><br /><span class=\"co2\">#include &quot;Arduino.h&quot;</span><br /><br /><span class=\"co2\">#define _GPS_VERSION 10 // software version of this library</span><br /><span class=\"co2\">#define _GPS_MPH_PER_KNOT 1.15077945</span><br /><span class=\"co2\">#define _GPS_MPS_PER_KNOT 0.51444444</span><br /><span class=\"co2\">#define _GPS_KMPH_PER_KNOT 1.852</span><br /><span class=\"co2\">#define _GPS_MILES_PER_METER 0.00062137112</span><br /><span class=\"co2\">#define _GPS_KM_PER_METER 0.001</span><br /><span class=\"co1\">//#define _GPS_NO_STATS</span><br /><br />class TinyGPS<br /><span class=\"br0\">&#123;</span><br /> public<span class=\"sy0\">:</span><br />  TinyGPS<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  bool encode<span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> c<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"co1\">// process one character received from GPS</span><br />  TinyGPS <span class=\"sy0\">&amp;</span>operator <span class=\"sy0\">&lt;&lt;</span> <span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> c<span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span>encode<span class=\"br0\">&#40;</span>c<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"kw1\">return</span> <span class=\"sy0\">*</span>this<span class=\"sy0\">;</span><span class=\"br0\">&#125;</span><br />  <br />  <span class=\"co1\">// lat/long in hundred thousandths of a degree and age of fix in milliseconds</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">void</span> get_position<span class=\"br0\">&#40;</span><span class=\"kw4\">long</span> <span class=\"sy0\">*</span>latitude<span class=\"sy0\">,</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>longitude<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> 0<span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>latitude<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>latitude <span class=\"sy0\">=</span> _latitude<span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>longitude<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>longitude <span class=\"sy0\">=</span> _longitude<span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>fix_age<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> _last_position_fix <span class=\"sy0\">==</span> GPS_INVALID_FIX_TIME <span class=\"sy0\">?</span> <br />    GPS_INVALID_AGE <span class=\"sy0\">:</span> millis<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">-</span> _last_position_fix<span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /><br />  <span class=\"co1\">// date as ddmmyy, time as hhmmsscc, and age in milliseconds</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">void</span> get_datetime<span class=\"br0\">&#40;</span><span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>date<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>time<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> 0<span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>date<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>date <span class=\"sy0\">=</span> _date<span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>time<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>time <span class=\"sy0\">=</span> _time<span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>fix_age<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> _last_time_fix <span class=\"sy0\">==</span> GPS_INVALID_FIX_TIME <span class=\"sy0\">?</span> <br />    GPS_INVALID_AGE <span class=\"sy0\">:</span> millis<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">-</span> _last_time_fix<span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /><br />  <span class=\"co1\">// signed altitude in centimeters (from GPGGA sentence)</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">long</span> altitude<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _altitude<span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br /><br />  <span class=\"co1\">// course in last full GPRMC sentence in 100th of a degree</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> course<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _course<span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <br />  <span class=\"co1\">// speed in last full GPRMC sentence in 100ths of a knot</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> speed<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _speed<span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br /><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br />  <span class=\"kw4\">void</span> stats<span class=\"br0\">&#40;</span><span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>chars<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> <span class=\"sy0\">*</span>good_sentences<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> <span class=\"sy0\">*</span>failed_cs<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><span class=\"co2\">#endif</span><br /><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">void</span> f_get_position<span class=\"br0\">&#40;</span><span class=\"kw4\">float</span> <span class=\"sy0\">*</span>latitude<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> <span class=\"sy0\">*</span>longitude<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> 0<span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   <span class=\"kw4\">long</span> lat<span class=\"sy0\">,</span> lon<span class=\"sy0\">;</span><br />   get_position<span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>lat<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>lon<span class=\"sy0\">,</span> fix_age<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"sy0\">*</span>latitude <span class=\"sy0\">=</span> lat <span class=\"sy0\">/</span> <span class=\"nu16\">100000.0</span><span class=\"sy0\">;</span><br />   <span class=\"sy0\">*</span>longitude <span class=\"sy0\">=</span> lon <span class=\"sy0\">/</span> <span class=\"nu16\">100000.0</span><span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">void</span> crack_datetime<span class=\"br0\">&#40;</span><span class=\"kw4\">int</span> <span class=\"sy0\">*</span>year<span class=\"sy0\">,</span> byte <span class=\"sy0\">*</span>month<span class=\"sy0\">,</span> byte <span class=\"sy0\">*</span>day<span class=\"sy0\">,</span> <br />   byte <span class=\"sy0\">*</span>hour<span class=\"sy0\">,</span> byte <span class=\"sy0\">*</span>minute<span class=\"sy0\">,</span> byte <span class=\"sy0\">*</span>second<span class=\"sy0\">,</span> byte <span class=\"sy0\">*</span>hundredths <span class=\"sy0\">=</span> 0<span class=\"sy0\">,</span> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> <span class=\"sy0\">*</span>fix_age <span class=\"sy0\">=</span> 0<span class=\"br0\">&#41;</span><br />  <span class=\"br0\">&#123;</span><br />   <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> date<span class=\"sy0\">,</span> time<span class=\"sy0\">;</span><br />   get_datetime<span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>date<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>time<span class=\"sy0\">,</span> fix_age<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>year<span class=\"br0\">&#41;</span> <br />   <span class=\"br0\">&#123;</span><br />    <span class=\"sy0\">*</span>year <span class=\"sy0\">=</span> date <span class=\"sy0\">%</span> <span class=\"nu0\">100</span><span class=\"sy0\">;</span><br />    <span class=\"sy0\">*</span>year <span class=\"sy0\">+=</span> <span class=\"sy0\">*</span>year <span class=\"sy0\">&gt;</span> 80 <span class=\"sy0\">?</span> 1900 <span class=\"sy0\">:</span> <span class=\"nu0\">2000</span><span class=\"sy0\">;</span><br />   <span class=\"br0\">&#125;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>month<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>month <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>date <span class=\"sy0\">/</span> 100<span class=\"br0\">&#41;</span> <span class=\"sy0\">%</span> <span class=\"nu0\">100</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>day<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>day <span class=\"sy0\">=</span> date <span class=\"sy0\">/</span> <span class=\"nu0\">10000</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>hour<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>hour <span class=\"sy0\">=</span> time <span class=\"sy0\">/</span> <span class=\"nu0\">1000000</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>minute<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>minute <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>time <span class=\"sy0\">/</span> 10000<span class=\"br0\">&#41;</span> <span class=\"sy0\">%</span> <span class=\"nu0\">100</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>second<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>second <span class=\"sy0\">=</span> <span class=\"br0\">&#40;</span>time <span class=\"sy0\">/</span> 100<span class=\"br0\">&#41;</span> <span class=\"sy0\">%</span> <span class=\"nu0\">100</span><span class=\"sy0\">;</span><br />   <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>hundredths<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span>hundredths <span class=\"sy0\">=</span> time <span class=\"sy0\">%</span> <span class=\"nu0\">100</span><span class=\"sy0\">;</span><br />  <span class=\"br0\">&#125;</span><br /><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_altitude<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span>  <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> altitude<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">/</span> <span class=\"nu16\">100.0</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_course<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span>   <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> course<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">/</span> <span class=\"nu16\">100.0</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_speed_knots<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> speed<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"sy0\">/</span> <span class=\"nu16\">100.0</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_speed_mph<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span>  <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _GPS_MPH_PER_KNOT <span class=\"sy0\">*</span> f_speed_knots<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_speed_mps<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span>  <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _GPS_MPS_PER_KNOT <span class=\"sy0\">*</span> f_speed_knots<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw2\">inline</span> <span class=\"kw4\">float</span> f_speed_kmph<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _GPS_KMPH_PER_KNOT <span class=\"sy0\">*</span> f_speed_knots<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br /><br />  <span class=\"kw4\">static</span> <span class=\"kw4\">int</span> library_version<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> _GPS_VERSION<span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br /><br />  <span class=\"kw2\">enum</span> <span class=\"br0\">&#123;</span>GPS_INVALID_AGE <span class=\"sy0\">=</span> 0xFFFFFFFF<span class=\"sy0\">,</span> GPS_INVALID_ANGLE <span class=\"sy0\">=</span> 999999999<span class=\"sy0\">,</span> GPS_INVALID_ALTITUDE <span class=\"sy0\">=</span> 999999999<span class=\"sy0\">,</span> GPS_INVALID_DATE <span class=\"sy0\">=</span> 0<span class=\"sy0\">,</span><br />   GPS_INVALID_TIME <span class=\"sy0\">=</span> 0xFFFFFFFF<span class=\"sy0\">,</span> GPS_INVALID_SPEED <span class=\"sy0\">=</span> 999999999<span class=\"sy0\">,</span> GPS_INVALID_FIX_TIME <span class=\"sy0\">=</span> 0xFFFFFFFF<span class=\"br0\">&#125;</span><span class=\"sy0\">;</span><br /><br /><br />  <span class=\"kw4\">static</span> <span class=\"kw4\">float</span> distance_between <span class=\"br0\">&#40;</span><span class=\"kw4\">float</span> lat1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> long1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> lat2<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> long2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><br />private<span class=\"sy0\">:</span><br />  <span class=\"kw2\">enum</span> <span class=\"br0\">&#123;</span>_GPS_SENTENCE_GPGGA<span class=\"sy0\">,</span> _GPS_SENTENCE_GPRMC<span class=\"sy0\">,</span> _GPS_SENTENCE_OTHER<span class=\"br0\">&#125;</span><span class=\"sy0\">;</span><br />  <br />  <span class=\"co1\">// properties</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _time<span class=\"sy0\">,</span> _new_time<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _date<span class=\"sy0\">,</span> _new_date<span class=\"sy0\">;</span><br />  <span class=\"kw4\">long</span> _latitude<span class=\"sy0\">,</span> _new_latitude<span class=\"sy0\">;</span><br />  <span class=\"kw4\">long</span> _longitude<span class=\"sy0\">,</span> _new_longitude<span class=\"sy0\">;</span><br />  <span class=\"kw4\">long</span> _altitude<span class=\"sy0\">,</span> _new_altitude<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _speed<span class=\"sy0\">,</span> _new_speed<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _course<span class=\"sy0\">,</span> _new_course<span class=\"sy0\">;</span><br /><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _last_time_fix<span class=\"sy0\">,</span> _new_time_fix<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _last_position_fix<span class=\"sy0\">,</span> _new_position_fix<span class=\"sy0\">;</span><br /><br />  <span class=\"co1\">// parsing state variables</span><br />  byte _parity<span class=\"sy0\">;</span><br />  bool _is_checksum_term<span class=\"sy0\">;</span><br />  <span class=\"kw4\">char</span> _term<span class=\"br0\">&#91;</span>15<span class=\"br0\">&#93;</span><span class=\"sy0\">;</span><br />  byte _sentence_type<span class=\"sy0\">;</span><br />  byte _term_number<span class=\"sy0\">;</span><br />  byte _term_offset<span class=\"sy0\">;</span><br />  bool _gps_data_good<span class=\"sy0\">;</span><br /><br /><span class=\"co2\">#ifndef _GPS_NO_STATS</span><br />  <span class=\"co1\">// statistics</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> _encoded_characters<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> _good_sentences<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> _failed_checksum<span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> _passed_checksum<span class=\"sy0\">;</span><br /><span class=\"co2\">#endif</span><br /><br />  <span class=\"co1\">// internal utilities</span><br />  <span class=\"kw4\">int</span> from_hex<span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> a<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> parse_decimal<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> parse_degrees<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  bool term_complete<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  bool gpsisdigit<span class=\"br0\">&#40;</span><span class=\"kw4\">char</span> c<span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span> <span class=\"kw1\">return</span> c <span class=\"sy0\">&gt;=</span> <span class=\"st0\">\'0\'</span> <span class=\"sy0\">&amp;&amp;</span> c <span class=\"sy0\">&lt;=</span> <span class=\"st0\">\'9\'</span><span class=\"sy0\">;</span> <span class=\"br0\">&#125;</span><br />  <span class=\"kw4\">long</span> gpsatol<span class=\"br0\">&#40;</span><span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <span class=\"kw4\">int</span> gpsstrcmp<span class=\"br0\">&#40;</span><span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str1<span class=\"sy0\">,</span> <span class=\"kw4\">const</span> <span class=\"kw4\">char</span> <span class=\"sy0\">*</span>str2<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><span class=\"sy0\">;</span><br /><br /><span class=\"co1\">// Arduino 0012 workaround</span><br /><span class=\"co2\">#undef int</span><br /><span class=\"co2\">#undef char</span><br /><span class=\"co2\">#undef long</span><br /><span class=\"co2\">#undef byte</span><br /><span class=\"co2\">#undef float</span><br /><span class=\"co2\">#undef abs</span><br /><span class=\"co2\">#undef round </span><br /><br /><span class=\"co2\">#endif</span><br /></code></pre>  </div>  </div>  </div>      <div class=\"fileWrapper txt\" id=\"f54f01bd3ea0e4b901c4b840225b76b7fea3177a\">  <p class=\"fileHead\">keywords.txt</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code>#######################################<br /># Syntax Coloring Map for TinyGPS<br />#######################################<br /><br />#######################################<br /># Datatypes (KEYWORD1)<br />#######################################<br /><br />TinyGPS KEYWORD1<br /><br />#######################################<br /># Methods and Functions (KEYWORD2)<br />#######################################<br /><br />encode KEYWORD2<br />get_position  KEYWORD2<br />get_datetime  KEYWORD2<br />altitude    KEYWORD2<br />speed  KEYWORD2<br />course KEYWORD2<br />stats  KEYWORD2<br />f_get_position KEYWORD2<br />crack_datetime KEYWORD2<br />f_altitude   KEYWORD2<br />f_course    KEYWORD2<br />f_speed_knots  KEYWORD2<br />f_speed_mph   KEYWORD2<br />f_speed_mps   KEYWORD2<br />f_speed_kmph  KEYWORD2<br />library_version KEYWORD2<br />distance_between    KEYWORD2<br /><br />#######################################<br /># Constants (LITERAL1)<br />#######################################<br /><br />GPS_INVALID_AGE LITERAL1<br />GPS_INVALID_ANGLE    LITERAL1<br />GPS_INVALID_ALTITUDE  LITERAL1<br />GPS_INVALID_DATE    LITERAL1<br />GPS_INVALID_TIME    LITERAL1</code></pre>  </div>  </div>  </div>      <div class=\"fileWrapper ino\" id=\"7fe15bda5562912d186e1f3e4ae51300763e9c8e\">  <p class=\"fileHead\">gps-distance.ino</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code><span class=\"co2\">#include &lt;SoftwareSerial.h&gt;</span><br /><span class=\"co2\">#include &lt;TinyGPS.h&gt;</span><br /><br /><span class=\"co2\">#define RXPIN 2</span><br /><span class=\"co2\">#define TXPIN 3</span><br /><span class=\"co2\">#define GPSBAUD 4800</span><br /><br />TinyGPS gps<span class=\"sy0\">;</span><br />SoftwareSerial uart_gps<span class=\"br0\">&#40;</span>RXPIN<span class=\"sy0\">,</span> TXPIN<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><br /><span class=\"kw4\">void</span> getgps<span class=\"br0\">&#40;</span>TinyGPS <span class=\"sy0\">&amp;</span>gps<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><br /><span class=\"kw4\">void</span> setup<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">begin</span><span class=\"br0\">&#40;</span>115200<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> uart_gps.<span class=\"me1\">begin</span><span class=\"br0\">&#40;</span>GPSBAUD<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;waiting for signal&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">void</span> loop<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span><br /> <br /> <br /> <span class=\"co1\">//Read the serial port to see if GPS data is available</span><br /> <span class=\"kw1\">while</span><span class=\"br0\">&#40;</span>uart_gps.<span class=\"me1\">available</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span><br />   <span class=\"kw4\">byte</span> c <span class=\"sy0\">=</span> uart_gps.<span class=\"me1\">read</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />  <br />   <span class=\"co1\">//If incoming data is GPS data, process it</span><br />   <span class=\"kw1\">if</span><span class=\"br0\">&#40;</span>gps.<span class=\"me1\">encode</span><span class=\"br0\">&#40;</span>c<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span><br />    getgps<span class=\"br0\">&#40;</span>gps<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br />   <span class=\"br0\">&#125;</span><br /> <span class=\"br0\">&#125;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"kw4\">void</span> getgps<span class=\"br0\">&#40;</span>TinyGPS <span class=\"sy0\">&amp;</span>gps<span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span><br /> <span class=\"kw4\">float</span> latitude<span class=\"sy0\">,</span> longitude<span class=\"sy0\">;</span><br /> <br /> <span class=\"co1\">//get and store our current lat/ long</span><br /> gps.<span class=\"me1\">f_get_position</span><span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>latitude<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>longitude<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <span class=\"co1\">//Calculate distance to north-pole (90 Lat 0 Long) in miles \'M\'</span><br /> <span class=\"kw4\">float</span> northPole <span class=\"sy0\">=</span> distance<span class=\"br0\">&#40;</span>latitude<span class=\"sy0\">,</span> longitude<span class=\"sy0\">,</span> <span class=\"nu0\">90</span><span class=\"sy0\">,</span> <span class=\"nu0\">0</span><span class=\"sy0\">,</span> <span class=\"st0\">\'M\'</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>northPole<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot; Miles from the north pole&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><br /><br /><br /><span class=\"kw4\">float</span> distance<span class=\"br0\">&#40;</span><span class=\"kw4\">float</span> lat1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> lon1<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> lat2<span class=\"sy0\">,</span> <span class=\"kw4\">float</span> lon2<span class=\"sy0\">,</span> <span class=\"kw4\">char</span> unit<span class=\"br0\">&#41;</span><span class=\"br0\">&#123;</span> <br /><span class=\"co1\">//Calculates the distance in between 2 points using long/lat. Set unit to \'M\', \'N\', or \'K\' for miles, nautical miles or kilometers</span><br /> <span class=\"kw4\">float</span> theta <span class=\"sy0\">=</span> lon1 <span class=\"sy0\">-</span> lon2<span class=\"sy0\">;</span> <br /> <br /> <span class=\"kw4\">float</span> dist <span class=\"sy0\">=</span> <a href=\"geshi/redirect.php?language=arduino&search=sin\"><span class=\"kw3\">sin</span></a><span class=\"br0\">&#40;</span>DEG_TO_RAD <span class=\"sy0\">*</span> lat1<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span> <a href=\"geshi/redirect.php?language=arduino&search=sin\"><span class=\"kw3\">sin</span></a><span class=\"br0\">&#40;</span>DEG_TO_RAD <span class=\"sy0\">*</span> lat2<span class=\"br0\">&#41;</span> <span class=\"sy0\">+</span> <a href=\"geshi/redirect.php?language=arduino&search=cos\"><span class=\"kw3\">cos</span></a><span class=\"br0\">&#40;</span>DEG_TO_RAD <span class=\"sy0\">*</span> lat1<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span> <a href=\"geshi/redirect.php?language=arduino&search=cos\"><span class=\"kw3\">cos</span></a><span class=\"br0\">&#40;</span>DEG_TO_RAD <span class=\"sy0\">*</span> lat2<span class=\"br0\">&#41;</span> <span class=\"sy0\">*</span> <a href=\"geshi/redirect.php?language=arduino&search=cos\"><span class=\"kw3\">cos</span></a><span class=\"br0\">&#40;</span>DEG_TO_RAD <span class=\"sy0\">*</span> theta<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /><br /> dist <span class=\"sy0\">=</span> acos<span class=\"br0\">&#40;</span>dist<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> dist <span class=\"sy0\">=</span> RAD_TO_DEG <span class=\"sy0\">*</span> dist<span class=\"sy0\">;</span> <br /> <span class=\"kw4\">float</span> miles <span class=\"sy0\">=</span> dist <span class=\"sy0\">*</span> 60 <span class=\"sy0\">*</span> <span class=\"nu16\">1.1515</span><span class=\"sy0\">;</span><br /><br /> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>unit <span class=\"sy0\">==</span> <span class=\"st0\">\'K\'</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">return</span> <span class=\"br0\">&#40;</span>miles <span class=\"sy0\">*</span> 1.609344<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <span class=\"br0\">&#125;</span> <span class=\"kw1\">else</span> <span class=\"kw1\">if</span> <span class=\"br0\">&#40;</span>unit <span class=\"sy0\">==</span> <span class=\"st0\">\'N\'</span><span class=\"br0\">&#41;</span> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">return</span> <span class=\"br0\">&#40;</span>miles <span class=\"sy0\">*</span> 0.8684<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span> <span class=\"kw1\">else</span> <span class=\"br0\">&#123;</span><br />  <span class=\"kw1\">return</span> miles<span class=\"sy0\">;</span><br /> <span class=\"br0\">&#125;</span><br /><span class=\"br0\">&#125;</span></code></pre>  </div>  </div>  </div>      <div class=\"fileWrapper ino\" id=\"bbdccfe2576ddc219084ccf5346865a656181b39\">  <p class=\"fileHead\">gps.ino</p>    <div class=\"fileCodeWrapper\">    <div class=\"lineNumbers\">  1<br />2<br />3<br />4<br />5<br />6<br />7<br />8<br />9<br />10<br />11<br />12<br />13<br />14<br />15<br />16<br />17<br />18<br />19<br />20<br />21<br />22<br />23<br />24<br />25<br />26<br />27<br />28<br />29<br />30<br />31<br />32<br />33<br />34<br />35<br />36<br />37<br />38<br />39<br />40<br />41<br />42<br />43<br />44<br />45<br />46<br />47<br />48<br />49<br />50<br />51<br />52<br />53<br />54<br />55<br />56<br />57<br />58<br />59<br />60<br />61<br />62<br />63<br />64<br />65<br />66<br />67<br />68<br />69<br />70<br />71<br />72<br />73<br />74<br />75<br />76<br />77<br />78<br />79<br />80<br />81<br />82<br />83<br />84<br />85<br />86<br />87<br />88<br />89<br />90<br />91<br />92<br />93<br />94<br />95<br />96<br />97<br />98<br />99<br />100<br />101<br />102<br />103<br />104<br />105<br />106<br />107<br />108<br />109<br />110<br />111<br />112<br />113<br />114<br />115<br />116<br />117<br />118<br />119<br />120<br />121<br />122<br />123<br />124<br />125<br />126<br />127<br />128<br />129<br />130<br />131<br />132<br />133<br />134<br />135<br />136<br />137<br />  </div>  <div class=\"code\">  <pre class=\"code\"><code><span class=\"coMULTI\">/*<br /> 6-8-10<br /> Aaron Weiss<br /> SparkFun Electronics<br /> <br /> Example GPS Parser based off of arduiniana.org TinyGPS examples.<br /> <br /> Parses NMEA sentences from an EM406 running at 4800bps into readable <br /> values for latitude, longitude, elevation, date, time, course, and <br /> speed. <br /> <br /> For the SparkFun GPS Shield. Make sure the switch is set to DLINE.<br /> <br /> Once you get your longitude and latitude you can paste your <br /> coordinates from the terminal window into Google Maps. Here is the <br /> link for SparkFun\'s location. <br /> http://maps.google.com/maps?q=40.06477,+-105.20997<br /> <br /> Uses the NewSoftSerial library for serial communication with your GPS, <br /> so connect your GPS TX and RX pin to any digital pin on the Arduino, <br /> just be sure to define which pins you are using on the Arduino to <br /> communicate with the GPS module. <br /> <br /> REVISIONS:<br /> 1-14-12 Arduino 1.0+ Compatible<br /> 1-17-11 <br />  changed values to RXPIN = 2 and TXPIN = to correspond with<br />  hardware v14+. Hardware v13 used RXPIN = 3 and TXPIN = 2.<br /> <br />*/</span> <br /><br /><span class=\"co1\">// In order for this sketch to work, you will need to download </span><br /><span class=\"co1\">// TinyGPS library from arduiniana.org and put them </span><br /><span class=\"co1\">// into the hardware-&gt;libraries folder in your ardiuno directory.</span><br /><span class=\"co2\">#include &lt;SoftwareSerial.h&gt;</span><br /><span class=\"co2\">#include &lt;TinyGPS.h&gt;</span><br /><br /><span class=\"co1\">// Define which pins you will use on the Arduino to communicate with your </span><br /><span class=\"co1\">// GPS. In this case, the GPS module\'s TX pin will connect to the </span><br /><span class=\"co1\">// Arduino\'s RXPIN which is pin 3.</span><br /><span class=\"co2\">#define RXPIN 2</span><br /><span class=\"co2\">#define TXPIN 3</span><br /><span class=\"co1\">//Set this value equal to the baud rate of your GPS</span><br /><span class=\"co2\">#define GPSBAUD 4800</span><br /><br /><span class=\"co1\">// Create an instance of the TinyGPS object</span><br />TinyGPS gps<span class=\"sy0\">;</span><br /><span class=\"co1\">// Initialize the NewSoftSerial library to the pins you defined above</span><br />SoftwareSerial uart_gps<span class=\"br0\">&#40;</span>RXPIN<span class=\"sy0\">,</span> TXPIN<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><br /><span class=\"co1\">// This is where you declare prototypes for the functions that will be </span><br /><span class=\"co1\">// using the TinyGPS library.</span><br /><span class=\"kw4\">void</span> getgps<span class=\"br0\">&#40;</span>TinyGPS <span class=\"sy0\">&amp;</span>gps<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><br /><span class=\"co1\">// In the setup function, you need to initialize two serial ports; the </span><br /><span class=\"co1\">// standard hardware serial port (Serial()) to communicate with your </span><br /><span class=\"co1\">// terminal program an another serial port (NewSoftSerial()) for your </span><br /><span class=\"co1\">// GPS.</span><br /><span class=\"kw4\">void</span> setup<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"co1\">// This is the serial rate for your terminal program. It must be this </span><br /> <span class=\"co1\">// fast because we need to print everything before a new sentence </span><br /> <span class=\"co1\">// comes in. If you slow it down, the messages might not be valid and </span><br /> <span class=\"co1\">// you will likely get checksum errors.</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">begin</span><span class=\"br0\">&#40;</span>115200<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"co1\">//Sets baud rate of your GPS</span><br /> uart_gps.<span class=\"me1\">begin</span><span class=\"br0\">&#40;</span>GPSBAUD<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;GPS Shield QuickStart Example Sketch v12&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;    ...waiting for lock...      &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"co1\">// This is the main loop of the code. All it does is check for data on </span><br /><span class=\"co1\">// the RX pin of the ardiuno, makes sure the data is valid NMEA sentences, </span><br /><span class=\"co1\">// then jumps to the getgps() function.</span><br /><span class=\"kw4\">void</span> loop<span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"kw1\">while</span><span class=\"br0\">&#40;</span>uart_gps.<span class=\"me1\">available</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span>   <span class=\"co1\">// While there is data on the RX pin...</span><br /> <span class=\"br0\">&#123;</span><br />   <span class=\"kw4\">int</span> c <span class=\"sy0\">=</span> uart_gps.<span class=\"me1\">read</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span>  <span class=\"co1\">// load the data into a variable...</span><br />   <span class=\"kw1\">if</span><span class=\"br0\">&#40;</span>gps.<span class=\"me1\">encode</span><span class=\"br0\">&#40;</span>c<span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span>   <span class=\"co1\">// if there is a new valid sentence...</span><br />   <span class=\"br0\">&#123;</span><br />    getgps<span class=\"br0\">&#40;</span>gps<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span>     <span class=\"co1\">// then grab the data.</span><br />   <span class=\"br0\">&#125;</span><br /> <span class=\"br0\">&#125;</span><br /><span class=\"br0\">&#125;</span><br /><br /><span class=\"co1\">// The getgps function will get and print the values we want.</span><br /><span class=\"kw4\">void</span> getgps<span class=\"br0\">&#40;</span>TinyGPS <span class=\"sy0\">&amp;</span>gps<span class=\"br0\">&#41;</span><br /><span class=\"br0\">&#123;</span><br /> <span class=\"co1\">// To get all of the data into varialbes that you can use in your code, </span><br /> <span class=\"co1\">// all you need to do is define variables and query the object for the </span><br /> <span class=\"co1\">// data. To see the complete list of functions see keywords.txt file in </span><br /> <span class=\"co1\">// the TinyGPS and NewSoftSerial libs.</span><br /> <br /> <span class=\"co1\">// Define the variables that will be used</span><br /> <span class=\"kw4\">float</span> latitude<span class=\"sy0\">,</span> longitude<span class=\"sy0\">;</span><br /> <span class=\"co1\">// Then call this function</span><br /> gps.<span class=\"me1\">f_get_position</span><span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>latitude<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>longitude<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"co1\">// You can now print variables latitude and longitude</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;Lat/Long: &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>latitude<span class=\"sy0\">,</span>5<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;, &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span>longitude<span class=\"sy0\">,</span>5<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <span class=\"co1\">// Same goes for date and time</span><br /> <span class=\"kw4\">int</span> year<span class=\"sy0\">;</span><br /> <span class=\"kw4\">byte</span> month<span class=\"sy0\">,</span> day<span class=\"sy0\">,</span> hour<span class=\"sy0\">,</span> minute<span class=\"sy0\">,</span> second<span class=\"sy0\">,</span> hundredths<span class=\"sy0\">;</span><br /> gps.<span class=\"me1\">crack_datetime</span><span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>year<span class=\"sy0\">,&amp;</span>month<span class=\"sy0\">,&amp;</span>day<span class=\"sy0\">,&amp;</span>hour<span class=\"sy0\">,&amp;</span>minute<span class=\"sy0\">,&amp;</span>second<span class=\"sy0\">,&amp;</span>hundredths<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"co1\">// Print data and time</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;Date: &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>month<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;/&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>day<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;/&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>year<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot; Time: &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>hour<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;:&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>minute<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;:&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span>second<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;.&quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span>hundredths<span class=\"sy0\">,</span> DEC<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"co1\">//Since month, day, hour, minute, second, and hundr</span><br /> <br /> <span class=\"co1\">// Here you can print the altitude and course values directly since </span><br /> <span class=\"co1\">// there is only one value for the function</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;Altitude (meters): &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span>gps.<span class=\"me1\">f_altitude</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <span class=\"co1\">// Same goes for course</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;Course (degrees): &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span>gps.<span class=\"me1\">f_course</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <br /> <span class=\"co1\">// And same goes for speed</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">print</span><span class=\"br0\">&#40;</span><span class=\"st0\">&quot;Speed(kmph): &quot;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span>gps.<span class=\"me1\">f_speed_kmph</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <a href=\"geshi/redirect.php?language=arduino&search=Serial\"><span class=\"kw3\">Serial</span></a>.<span class=\"me1\">println</span><span class=\"br0\">&#40;</span><span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <br /> <span class=\"co1\">// Here you can print statistics on the sentences.</span><br /> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">long</span> chars<span class=\"sy0\">;</span><br /> <span class=\"kw4\">unsigned</span> <span class=\"kw4\">short</span> sentences<span class=\"sy0\">,</span> failed_checksum<span class=\"sy0\">;</span><br /> gps.<span class=\"me1\">stats</span><span class=\"br0\">&#40;</span><span class=\"sy0\">&amp;</span>chars<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>sentences<span class=\"sy0\">,</span> <span class=\"sy0\">&amp;</span>failed_checksum<span class=\"br0\">&#41;</span><span class=\"sy0\">;</span><br /> <span class=\"co1\">//Serial.print(&quot;Failed Checksums: &quot;);Serial.print(failed_checksum);</span><br /> <span class=\"co1\">//Serial.println(); Serial.println();</span><br /><span class=\"br0\">&#125;</span><br /></code></pre>  </div>  </div>  </div>    </div></div><div class=\"footer\">powered by <a title=\"github.com\" href=\"http://github.com\">github</a><!-- Served in 0.0062441825866699 sec - loaded from cache: yes - limitLeft:  of  --!></div></div>');
new Embed("GPS-EM-406A_sidebar", "GPS-EM-406A_code", {"sha":"f2ab4c2ca645a9f9574f94e5276c95aaf1f18002","url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/trees\/f2ab4c2ca645a9f9574f94e5276c95aaf1f18002","tree":[{"path":"License.txt","mode":"100755","type":"blob","sha":"b132efea8543fe82d1fd16a19298a9840f395e17","size":1073,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/b132efea8543fe82d1fd16a19298a9840f395e17"},{"path":"README.md","mode":"100644","type":"blob","sha":"f858d36c6a28ae17f9e58ce8cc97cbe23b552679","size":620,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/f858d36c6a28ae17f9e58ce8cc97cbe23b552679"},{"path":"TinyGPS10\/TinyGPS.cpp","mode":"100755","type":"blob","sha":"06a17207a19ff52b4d6535863c1d702bb5844847","size":7541,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/06a17207a19ff52b4d6535863c1d702bb5844847"},{"path":"TinyGPS10\/TinyGPS.h","mode":"100755","type":"blob","sha":"71ca21f8e5acbf7d17bf14013936b8f89c12c65e","size":5626,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/71ca21f8e5acbf7d17bf14013936b8f89c12c65e"},{"path":"TinyGPS10\/keywords.txt","mode":"100755","type":"blob","sha":"f54f01bd3ea0e4b901c4b840225b76b7fea3177a","size":939,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/f54f01bd3ea0e4b901c4b840225b76b7fea3177a"},{"path":"gps-distance.ino","mode":"100755","type":"blob","sha":"7fe15bda5562912d186e1f3e4ae51300763e9c8e","size":1533,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/7fe15bda5562912d186e1f3e4ae51300763e9c8e"},{"path":"gps.ino","mode":"100755","type":"blob","sha":"bbdccfe2576ddc219084ccf5346865a656181b39","size":5039,"url":"https:\/\/api.github.com\/repos\/ameyer\/GPS-EM-406A\/git\/blobs\/bbdccfe2576ddc219084ccf5346865a656181b39"}],"truncated":false})

<!-- Served in 0.0070590972900391 sec - loaded from cache: yes - limitLeft:  of  --!>