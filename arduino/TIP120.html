<!DOCTYPE html >

<html lang="en">
<head>
<meta charset="utf-8"/>
<link href="style/main.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.0/mootools-yui-compressed.js" type="text/javascript"></script>
<script type="text/javascript">
	
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	
	ga('create', 'UA-4050921-11', 'auto');
	ga('send', 'pageview');
	
	function nospam(user,domain) { window.location = "mailto:" + user + "@" + domain; }
		
		
	window.addEvent('domready', function(){

		$$('.codeHead .copy').addEvent('click', function(event) {
			this.highlight();
			event.stop();
			
			var code = this.getParent('.codesnip-container').getElement('.codesnip');
			
			if (code.select) {
				code.select();
			}else if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(code);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(code);
				window.getSelection().addRange(range);
			}
			
			
			try {
				var successful = document.execCommand('copy');
				var msg = successful ? 'successful' : 'unsuccessful';
				console.log('Copying text command was ' + msg);
			} catch (err) {
				console.log('Oops, unable to copy');
			}
		});
	
	});
	</script>
<!--
	
	Icon Set:	IcoMoon - Free -- http://keyamoon.com/icomoon/
	License:	CC BY-SA 3.0 -- http://creativecommons.org/licenses/by-sa/3.0/
	
	
	Icon Set:	Broccolidry -- http://dribbble.com/shots/587469-Free-16px-Broccolidryiconsaniconsetitisfullof-icons
	License:	Aribitrary -- http://licence.visualidiot.com/
	
	-->
<title>Adam meyer | Arduino</title>
</head>
<body>
<div id="headerWrapper">
<div id="header">
<h1><a href="http://adam-meyer.com">Adam meyer</a></h1>
<h2>Design + Code</h2>
<div id="topNav">
<a href="../about.html" id="aboutLink">About</a>
<a href="../resume.pdf">Resume</a>
<a href="../index.html">Portfolio</a>
<a href="index.html">Arduino Articles</a>
<span id="contactLink"><span onclick="javascript:nospam('sternmeyer','gmail.com');">Contact</span>
<div id="contactLinks">
<a class="icon-twitter" href="http://twitter.com/sternmeyer" title="twitter"></a>
<a class="icon-linkedin" href="http://www.linkedin.com/pub/adam-meyer/20/7a/850/" title="linked in"></a>
<a class="icon-dribbble" href="http://dribbble.com/ameyer" title="dribbble"></a>
<a class="icon-github" href="https://github.com/ameyer" title="github"></a>
<a class="icon-instagram" href="http://instagram.com/sternmeyer" title="instagram"></a>
<a class="icon-envelope2" href="mailto:sternmeyer@gmail.com" title="email"></a>
</div>
</span>
</div>
</div>
</div>
<div id="articleWrapper">
<div class="content">
<div class="post"><h2>High-Power Control: Arduino + TIP120 Transistor</h2>
<div class="postContent">
<p><img class="noFrame" src="images/2011/03/tip120.jpg"/></p>
<div class="columnBody">
<div class="leftColumn">
<p>Up until now, we have talked about working with a lot of low-power devices. Sensors, LEDs, ICs, and the like are all capable of being powered directly from your Arduino, but as many awesome 5 and 3.3v components as there are, eventually you will find yourself holding a 12v solenoid, motor, or light and wondering "How the heck am I supposed to control this from my Arduino?" Well today we are going to talk about doing just that from a magical device know as a transistor, specifically the TIP120 Darlington Transistor.</p>
<p>The reason I'm covering this particular transistor is because it is readily available, and you can usually pick one up from <a href="http://www.radioshack.com/">Radio Shack</a>, <a href="http://www.adafruit.com/products/976">Adafruit</a> or other local parts store in a jam, but you can use any NPN darlington transistor like the <a href="http://www.bourns.com/pdfs/bd645.pdf">BD651</a> exactly the same way.</p>
<h3>How this works</h3>
<p>WARNING: I am about to simplify the crud out of this, so beware... it is here in an attempt to explain, in simple terms, what is going on.</p>
<p>If you don't know transistors at all, they are 3 lead components that have 2 simple functions, to switch or amplify (in this example it is setup as a switch). You basically have an <strong>In</strong> called the <strong>Collector</strong>, an <strong>Out</strong> called the <strong>Emitter</strong>, and a <strong>Control</strong> called the <strong>Base</strong>. When you send a HIGH signal to the base (control pin), the transistor switches and allows current to flow from the collector (in) to the emitter (out).</p>
<p>So we connect it so that our motor, solenoid or light is connected to V+ but not ground (V-). Ground is connected to the transistor's collector. When our arduino sends a HIGH signal to the transistor's base, it switches the transistor (connecting the collector and emitter) and completes the circuit for the motor, solenoid, or light.</p>
</div>
<div class="rightColumn">
<p><a href="images/2011/03/tip120-solenoid.png"><img alt="" class="noFrame" src="images/2011/03/tip120-solenoid-400x225.png" title="tip120-solenoid"/></a></p>
<p><a href="images/2011/03/tip120-motor.png"><img alt="" class="noFrame" src="images/2011/03/tip120-motor-400x225.png" title="tip120-motor"/></a></p>
<p><a href="images/2011/03/tip120-lightbulb1.png"><img alt="" class="noFrame" src="images/2011/03/tip120-lightbulb1-400x225.png" title="tip120-lightbulb"/></a></p>
</div>
</div>
<div class="wideBody">
<h3>Hooking it up / What's the diode used for?</h3>
<p>This circuit is pretty simple. This type of transistor is switched by current and not voltage, so we need to make sure to supply the correct current to the base to switch it, so a resistor is connected from the Arduino to the base to limit the current to the proper amount.</p>
<p>You can see that in 2 of the 3 illustrations, there is a diode parallel to the device we are powering. Any time you are powering a device with a coil, such as a relay, solenoid, or motor, you need this guy, and don't leave home without it. What happens is when you stop powering the coil, a reverse voltage, up to several hundred volts, spikes back. This only lasts a few microseconds, but it is enough to kill our transistor. So this diode (only allows current to pass one way) is normally facing the wrong direction and does nothing. But when that voltage spikes comes flowing the opposite direction, the diode allows it to flow back to the coil and not the transistor. We will need a diode fast enough to react to the kickback, and strong enough to take the load. A rectifier diode like the 1N4001 or <a href="http://www.fairchildsemi.com/ds/SB/SB560.pdf">SB560</a> should do the job. If you are looking for extra protection you could use an <a href="http://en.wikipedia.org/wiki/Opto-isolator">optoisolator</a> between the Arduino and the transistor. An optoisolator optically isolates both sides (high and low power) of the circuit so the high-voltage can not possibly come back to the microcontroller. </p>
<p>Just make sure that protection diode is facing the correct way (stripe facing the V+ of device). If it is facing the wrong direction, the device you are trying to power will not work as the diode will just allow the current to bypass it.</p>
<h3>Limitations</h3>
<p>Transistors like the TIP120 are really great for controlling high-power devices from your microcontroller, but they do have some limitations. This current configuration is only useful for switching DC current, so don't try this with an AC source, also transistors have both a voltage and an amperage/current limitation. The TIP120 can handle switching up to 60V, and the amperage is limited to 5A, or up to 8A pulses of 300µs. I have managed to blow out one of these with a 5A load because of heat. Actually anything over a few amps, especially when the current is constant (like in a motor) and not short pulses, I would recommend using a heat-sink. I usually just solder a bent pice of metal to the back, just something to help dissipate the heat. Just note, if you are using more than one of the TIP120s, you can not solder them to the same heat-sink as the back is connected to the base of the transistor, not the emitter. If you need to switch more than 5A or AC, I would look at using a relay instead.</p>
<h3>Fade it!</h3>
<p>You know the PWM outputs on your Arduino? Yeah, the thing that allows you to <strong>analogWrite(pin, value)</strong>. Well, PWM is not actually an analog output. The Arduino is actually pulsing (very quickly) between 0 and 5v so that the average voltage is somewhere in between 0 and 5. Because of this, the PWM can be extended through the transistor (the transistor can only turn on or off, but can do so very quickly) allowing us to fade lights or control the speed of a motor just like if they were connected directly to the Arduino. All you need to do in order to take advantage of this is make sure the TIP120's base is connected to a PWM pin.
</p></div>
<h3>Code</h3>
<p>You don't really need code for this, you just send a HIGH signal to the base pin, and BAM... it works. But I threw this together for you so you can test it fading with the PWM- This code fades in a sin wave like the video below. (only useful for a motor or light obviously).</p>
<div class="codesnip-container">
<div class="codeHead">
<a class="copy" href="#">Copy Code</a>
</div>
<pre class="arduino codesnip" style="font-family:monospace;"><span class="co1">//////////////////////////////////////////////////////////////////</span>
<span class="co1">//©2011 bildr</span>
<span class="co1">//Released under the MIT License - Please reuse change and share</span>
<span class="co1">//Simple code to output a PWM sine wave signal on pin 9</span>
<span class="co1">//////////////////////////////////////////////////////////////////</span>

<span class="co2">#define fadePin 9</span>

<span class="kw4">void</span> setup<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="kw3">pinMode</span><span class="br0">(</span>fadePin<span class="sy0">,</span> <span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy0">;</span>  
<span class="br0">}</span>

<span class="kw4">void</span> loop<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>

  <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i<span class="sy0">&lt;</span><span class="nu0">360</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span><span class="br0">{</span>
    <span class="co1">//convert 0-360 angle to radian (needed for sin function)</span>
    <span class="kw4">float</span> rad <span class="sy0">=</span> DEG_TO_RAD <span class="sy0">*</span> i<span class="sy0">;</span>

    <span class="co1">//calculate sin of angle as number between 0 and 255</span>
    <span class="kw4">int</span> sinOut <span class="sy0">=</span> <span class="kw3">constrain</span><span class="br0">(</span><span class="br0">(</span><span class="kw3">sin</span><span class="br0">(</span>rad<span class="br0">)</span> <span class="sy0">*</span> 128<span class="br0">)</span> <span class="sy0">+</span> 128<span class="sy0">,</span> 0<span class="sy0">,</span> 255<span class="br0">)</span><span class="sy0">;</span> 

    <span class="kw3">analogWrite</span><span class="br0">(</span>fadePin<span class="sy0">,</span> sinOut<span class="br0">)</span><span class="sy0">;</span>

    <span class="kw3">delay</span><span class="br0">(</span>15<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>


<span class="br0">}</span></pre>
<div class="codeFoot">
				Unless otherwise stated, this code is released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> - Please use, change and share it.
			</div>
</div>
<h3>Video</h3>
<p>This video is showing the capabilities of PWM with the TIP120.  The light, though it looks like a standard house light, is actually a <a href="http://www.amazon.com/15-Watt-Frosted-Appliance-Ceiling/dp/B0042F8HLS">15W 12V DC light</a>.</p>
<p><iframe frameborder="0" height="534" src="http://player.vimeo.com/video/4402701?byline=0&amp;portrait=0" width="949"></iframe></p>
<h3>Extending this</h3>
<p>This is something so basic that you will find your self with an abundance of things to use this with. Most recently I put this to use in a few places: I helped a local artist create an automatic morse code machine, helped a friend prototype a touch-based light dimmer (test video above), and at work, I use it for controlling <a href="http://stream.tellart.com/2011/02/13/bells/">8 musical bells over the internet</a>.</p>
</div>
<div id="attribution">
<p>Article taken from <a href="http://bildr.org/high-power-control-with-arduino-and-tip120">bildr.org</a> with minor changes - <i>I am the original author of this content</i></p>
<div id="attributionIcons">
<div class="ccIcon cc"></div>
<div class="ccIcon sa"></div>
<div class="ccIcon attribution"></div>
<div id="attributionText">
<a href="https://creativecommons.org/licenses/by-sa/3.0/">Content available under:<br/>Attribution-Share Alike 3.0 Unported</a>
</div>
</div>
</div>
</div></div></div></body></html>