<!DOCTYPE html >

<html lang="en">
<head>
<meta charset="utf-8"/>
<link href="style/main.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.0/mootools-yui-compressed.js" type="text/javascript"></script>
<script type="text/javascript">
	
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	
	ga('create', 'UA-4050921-11', 'auto');
	ga('send', 'pageview');
	
	function nospam(user,domain) { window.location = "mailto:" + user + "@" + domain; }
		
		
	window.addEvent('domready', function(){

		$$('.codeHead .copy').addEvent('click', function(event) {
			this.highlight();
			event.stop();
			
			var code = this.getParent('.codesnip-container').getElement('.codesnip');
			
			if (code.select) {
				code.select();
			}else if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(code);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(code);
				window.getSelection().addRange(range);
			}
			
			
			try {
				var successful = document.execCommand('copy');
				var msg = successful ? 'successful' : 'unsuccessful';
				console.log('Copying text command was ' + msg);
			} catch (err) {
				console.log('Oops, unable to copy');
			}
		});
	
	});
	</script>
<!--
	
	Icon Set:	IcoMoon - Free -- http://keyamoon.com/icomoon/
	License:	CC BY-SA 3.0 -- http://creativecommons.org/licenses/by-sa/3.0/
	
	
	Icon Set:	Broccolidry -- http://dribbble.com/shots/587469-Free-16px-Broccolidryiconsaniconsetitisfullof-icons
	License:	Aribitrary -- http://licence.visualidiot.com/
	
	-->
<title>Adam meyer | Arduino</title>
</head>
<body>
<div id="headerWrapper">
<div id="header">
<h1><a href="http://adam-meyer.com">Adam meyer</a></h1>
<h2>Design + Code</h2>
<div id="topNav">
<a href="../about.html" id="aboutLink">About</a>
<a href="../resume.pdf">Resume</a>
<a href="../index.html">Portfolio</a>
<a href="index.html">Arduino Articles</a>
<span id="contactLink"><span onclick="javascript:nospam('sternmeyer','gmail.com');">Contact</span>
<div id="contactLinks">
<a class="icon-twitter" href="http://twitter.com/sternmeyer" title="twitter"></a>
<a class="icon-linkedin" href="http://www.linkedin.com/pub/adam-meyer/20/7a/850/" title="linked in"></a>
<a class="icon-dribbble" href="http://dribbble.com/ameyer" title="dribbble"></a>
<a class="icon-github" href="https://github.com/ameyer" title="github"></a>
<a class="icon-instagram" href="http://instagram.com/sternmeyer" title="instagram"></a>
<a class="icon-envelope2" href="mailto:sternmeyer@gmail.com" title="email"></a>
</div>
</span>
</div>
</div>
</div>
<div id="articleWrapper">
<div class="content">
<div class="post"><h2>Line Sensing. QRE1113 Reflectance Sensor + Arduino</h2>
<div class="postContent">
<p><img class="noFrame" src="images/2011/06/QRE113.jpg"/></p>
<div class="columnBody">
<div class="leftColumn">
<p>The QRE1113 is a common reflectance sensor often used in robotic line followers. The sensor works by shining an IR LED down and seeing how much of that light bounces back using a phototransistor. Because dark colors will bounce back less of the light, the sensor can be used to tell the difference between white and black areas. So an array of these can be used to help a robot determine where a dark line is on the ground so it can follow it. But they can also be used to determine proximity under an inch.</p>
<p>Both <a href="http://www.pololu.com/">Pololu</a> and <a href="http://www.sparkfun.com">Sparkfun</a> sell <a href="http://www.sparkfun.com/products/9454">digital</a> and <a href="http://www.sparkfun.com/products/9453">analog</a> models of a QRE1113 breakout board. The <a href="http://www.pololu.com/catalog/product/958">analog version</a> is very simple, it just outputs an analog voltage on the signal pin relative to how much light was reflected. And you might think the <a href="http://www.pololu.com/catalog/product/959">digital version</a>, especially being called a line sensor by sparkfun, would just output HIGH when it sees a line, and LOW when it does not. But this is not the case.</p>
<p>The digital version is designed for times you do not have an analog input on your microcontroller but still need an analog reading of how much light was reflected. It does this by allowing you to charge a capacitor on the board, and then timing how long it takes to discharge. The more light that is reflected, the less time it takes to discharge the capacitor. In my tests, the times ranged between 10 microseconds (10/million) to 2.5 milliseconds, so this is all done very quickly and wont put much of a delay in your code.</p>
<h3>Hooking Them Up</h3>
<p>Hooking the QRE1113 to your Arduino is very simple. It just needs power (5V), ground, and an analog or digital pin depending on what version you have.</p>
</div>
<div class="rightColumn">
<p><a href="images/2011/06/QRE113_analog.png"><img alt="" class="alignleft size-medium wp-image-1533" height="275" src="images/2011/06/QRE113_analog-400x275.png" title="QRE1113_analog" width="400"/></a></p>
<p><a href="images/2011/06/QRE113_digital.png"><img alt="" class="alignleft size-medium wp-image-1534" height="275" src="images/2011/06/QRE113_digital-400x275.png" title="QRE1113_digital" width="400"/></a></p>
</div>
</div>
<h3>Code</h3>
<p>The method of reading the values from the analog and digital version is very different, so we have 2 code examples for you.</p>
<h4>Analog Version</h4>
<div class="codesnip-container">
<div class="codeHead">
<a class="copy" href="#">Copy Code</a>
</div>
<pre class="arduino codesnip" style="font-family:monospace;"><span class="co1">//Code for the QRE1113 Analog board</span>
<span class="co1">//Outputs via the serial terminal - Lower numbers mean more reflected</span>
<span class="kw4">int</span> QRE1113_Pin <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> <span class="co1">//connected to analog 0</span>

<span class="kw4">void</span> setup<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="kw3">Serial</span>.<span class="me1">begin</span><span class="br0">(</span>9600<span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>


<span class="kw4">void</span> loop<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>

  <span class="kw4">int</span> QRE_Value <span class="sy0">=</span> <span class="kw3">analogRead</span><span class="br0">(</span>QRE1113_Pin<span class="br0">)</span><span class="sy0">;</span>
  <span class="kw3">Serial</span>.<span class="me1">println</span><span class="br0">(</span>QRE_Value<span class="br0">)</span><span class="sy0">;</span> 

<span class="br0">}</span></pre>
<div class="codeFoot">
				Unless otherwise stated, this code is released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> - Please use, change and share it.
			</div>
</div>
<h4>Digital Version</h4>
<div class="codesnip-container">
<div class="codeHead">
<a class="copy" href="#">Copy Code</a>
</div>
<pre class="arduino codesnip" style="font-family:monospace;"><span class="co1">//Code for the QRE1113 Digital board</span>
<span class="co1">//Outputs via the serial terminal - Lower numbers mean more reflected</span>
<span class="co1">//3000 or more means nothing was reflected.</span>

<span class="kw4">int</span> QRE1113_Pin <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span> <span class="co1">//connected to digital 2</span>

<span class="kw4">void</span> setup<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="kw3">Serial</span>.<span class="me1">begin</span><span class="br0">(</span>9600<span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>


<span class="kw4">void</span> loop<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>

  <span class="kw4">int</span> QRE_Value <span class="sy0">=</span> readQD<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw3">Serial</span>.<span class="me1">println</span><span class="br0">(</span>QRE_Value<span class="br0">)</span><span class="sy0">;</span> 

<span class="br0">}</span>


<span class="kw4">int</span> readQD<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="co1">//Returns value from the QRE1113 </span>
  <span class="co1">//Lower numbers mean more refleacive</span>
  <span class="co1">//More than 3000 means nothing was reflected.</span>
  <span class="kw3">pinMode</span><span class="br0">(</span> QRE1113_Pin<span class="sy0">,</span> <span class="kw2">OUTPUT</span> <span class="br0">)</span><span class="sy0">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span> QRE1113_Pin<span class="sy0">,</span> <span class="kw2">HIGH</span> <span class="br0">)</span><span class="sy0">;</span>  
  <span class="kw3">delayMicroseconds</span><span class="br0">(</span>10<span class="br0">)</span><span class="sy0">;</span>
  <span class="kw3">pinMode</span><span class="br0">(</span> QRE1113_Pin<span class="sy0">,</span> <span class="kw2">INPUT</span> <span class="br0">)</span><span class="sy0">;</span>

  <span class="kw4">long</span> time <span class="sy0">=</span> <span class="kw3">micros</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>

  <span class="co1">//time how long the input is HIGH, but quit after 3ms as nothing happens after that</span>
  <span class="kw1">while</span> <span class="br0">(</span><span class="kw3">digitalRead</span><span class="br0">(</span>QRE1113_Pin<span class="br0">)</span> <span class="sy0">==</span> <span class="kw2">HIGH</span> <span class="sy0">&amp;&amp;</span> <span class="kw3">micros</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">-</span> time <span class="sy0">&lt;</span> 3000<span class="br0">)</span><span class="sy0">;</span> 
  <span class="kw4">int</span> diff <span class="sy0">=</span> <span class="kw3">micros</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">-</span> time<span class="sy0">;</span>

  <span class="kw1">return</span> diff<span class="sy0">;</span>
<span class="br0">}</span></pre>
<div class="codeFoot">
				Unless otherwise stated, this code is released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> - Please use, change and share it.
			</div>
</div>
</div>
<div id="attribution">
<p>Article taken from <a href="http://bildr.org/qre1113-arduino">bildr.org</a> with minor changes - <i>I am the original author of this content</i></p>
<div id="attributionIcons">
<div class="ccIcon cc"></div>
<div class="ccIcon sa"></div>
<div class="ccIcon attribution"></div>
<div id="attributionText">
<a href="https://creativecommons.org/licenses/by-sa/3.0/">Content available under:<br/>Attribution-Share Alike 3.0 Unported</a>
</div>
</div>
</div>
</div></div></div></body></html>