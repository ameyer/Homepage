<!DOCTYPE html >

<html lang="en">
<head>
<meta charset="utf-8"/>
<link href="style/main.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.0/mootools-yui-compressed.js" type="text/javascript"></script>
<script type="text/javascript">
	
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	
	ga('create', 'UA-4050921-11', 'auto');
	ga('send', 'pageview');
	
	function nospam(user,domain) { window.location = "mailto:" + user + "@" + domain; }
		
		
	window.addEvent('domready', function(){

		$$('.codeHead .copy').addEvent('click', function(event) {
			this.highlight();
			event.stop();
			
			var code = this.getParent('.codesnip-container').getElement('.codesnip');
			
			if (code.select) {
				code.select();
			}else if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(code);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(code);
				window.getSelection().addRange(range);
			}
			
			
			try {
				var successful = document.execCommand('copy');
				var msg = successful ? 'successful' : 'unsuccessful';
				console.log('Copying text command was ' + msg);
			} catch (err) {
				console.log('Oops, unable to copy');
			}
		});
	
	});
	</script>
<!--
	
	Icon Set:	IcoMoon - Free -- http://keyamoon.com/icomoon/
	License:	CC BY-SA 3.0 -- http://creativecommons.org/licenses/by-sa/3.0/
	
	
	Icon Set:	Broccolidry -- http://dribbble.com/shots/587469-Free-16px-Broccolidryiconsaniconsetitisfullof-icons
	License:	Aribitrary -- http://licence.visualidiot.com/
	
	-->
<title>Adam meyer | Arduino</title>
</head>
<body>
<div id="headerWrapper">
<div id="header">
<h1><a href="http://adam-meyer.com">Adam meyer</a></h1>
<h2>Design + Code</h2>
<div id="topNav">
<a href="../about.html" id="aboutLink">About</a>
<a href="../resume.pdf">Resume</a>
<a href="../index.html">Portfolio</a>
<a href="index.html">Arduino Articles</a>
<span id="contactLink"><span onclick="javascript:nospam('sternmeyer','gmail.com');">Contact</span>
<div id="contactLinks">
<a class="icon-twitter" href="http://twitter.com/sternmeyer" title="twitter"></a>
<a class="icon-linkedin" href="http://www.linkedin.com/pub/adam-meyer/20/7a/850/" title="linked in"></a>
<a class="icon-dribbble" href="http://dribbble.com/ameyer" title="dribbble"></a>
<a class="icon-github" href="https://github.com/ameyer" title="github"></a>
<a class="icon-instagram" href="http://instagram.com/sternmeyer" title="instagram"></a>
<a class="icon-envelope2" href="mailto:sternmeyer@gmail.com" title="email"></a>
</div>
</span>
</div>
</div>
</div>
<div id="articleWrapper">
<div class="content">
<div class="post"><h2>High-Power Control: Arduino + N-Channel MOSFET</h2>
<div class="postContent">
<p><img class="noFrame" src="images/2011/03/tip120.jpg"/></p>
<div class="columnBody">
<div class="leftColumn">
<p>Eventually you are going to find yourself holding a 12v solenoid, motor, or light and wondering "How the heck am I supposed to control this from my Arduino?" And we have <a href="./high-power-control-with-arduino-and-tip120">covered this in the past</a>. Today we are going to talk about another way of doing just that, this time with an N-Channel MOSFET <strong>metal–oxide–semiconductor field-effect transistor</strong>, specifically the RFP30N06LE MOSFET (You can pick these up from <a href="http://www.sparkfun.com/products/10213">sparkfun</a>). <strong>but you can use any N-Channel MOSFET exactly the same way.</strong></p>
<h3>How this works</h3>
<p>WARNING: I am about to simplify the crud out of this, so beware... it is here in an attempt to explain, in simple terms, what is going on.</p>
<p>First off, a MOSFET is a transistor, just a special kind.</p>
<p>If you don't know transistors at all, they are 3 lead components that have 2 simple functions, to switch or amplify (in this example it is setup as a switch). You basically have an <strong>In</strong> called the <strong>Source</strong>, an <strong>Out</strong> called the <strong>Drain</strong>, and a <strong>Control</strong> called the <strong>Gate</strong>. When you send a HIGH signal to the gate (control pin), the transistor switches and allows current to flow from the source (in) to the drain (out).</p>
<p>So we connect it so that our motor, solenoid or light is connected to V+ but not ground (V-). Ground is connected to the transistor's drain. When our arduino sends a HIGH signal to the transistor's gate, it switches the transistor (connecting the drain and source) and completes the circuit for the motor, solenoid, or light.</p>
<h3>More Information</h3>
<p>If you want to know more, or actually know what is actually going on in there. <a href="http://www.sparkfun.com/news/819">Pete over at Sparkfun put out amazing video explaining MOSFETs for a solid 20min</a>. Highly recommended.</p>
</div>
<div class="rightColumn">
<p><a href="images/2012/03/rfp30n06le-arduino-solenoid.png"><img alt="" class="alignleft size-medium wp-image-2018" height="218" src="images/2012/03/rfp30n06le-arduino-solenoid-400x218.png" title="rfp30n06le-arduino-solenoid" width="400"/></a></p>
<p><a href="images/2012/03/rfp30n06le-arduino-motor.png"><img alt="" class="alignleft size-medium wp-image-2019" height="218" src="images/2012/03/rfp30n06le-arduino-motor-400x218.png" title="rfp30n06le-arduino-motor" width="400"/></a></p>
<p><a href="images/2012/03/rfp30n06le-arduino-lightbulb.png"><img alt="" class="alignleft size-medium wp-image-2017" height="218" src="images/2012/03/rfp30n06le-arduino-lightbulb-400x218.png" title="rfp30n06le-arduino-lightbulb" width="400"/></a>
</p></div>
</div>
<div class="wideBody">
<h3>Hooking it up / What's the diode used for?</h3>
<p>This circuit is pretty simple. The only part that looks funny is the resistor. This is a pull-down resistor. The resistor holds the gate low when the arduino does not send a high signal. This is here incase the arduino comes loose, or the wiring is bad it will default to off. You don't want this pin to ever be floating as it will trigger on and off.</p>
<p>You can see that in 2 of the 3 illustrations, there is a diode parallel to the device we are powering. Any time you are powering a device with a coil, such as a relay, solenoid, or motor, you need this guy, and don't leave home without it. What happens is when you stop powering the coil, a reverse voltage, up to several hundred volts, spikes back. This only lasts a few microseconds, but it is enough to kill our MOSFET. So this diode (only allows current to pass one way) is normally facing the wrong direction and does nothing. But when that voltage spikes comes flowing the opposite direction, the diode allows it to flow back to the coil and not the transistor. We will need a diode fast enough to react to the kickback, and strong enough to take the load. A rectifier diode like the 1N4001 or <a href="http://www.fairchildsemi.com/ds/SB/SB560.pdf">SB560</a> should do the job. If you are looking for extra protection you could use an <a href="http://en.wikipedia.org/wiki/Opto-isolator">optoisolator</a> between the Arduino and the transistor. An optoisolator optically isolates both sides (high and low power) of the circuit so the high-voltage can not possibly come back to the microcontroller. </p>
<p>Just make sure that protection diode is facing the correct way (stripe facing the V+ of device). If it is facing the wrong direction, the device you are trying to power will not work as the diode will just allow the current to bypass it.</p>
<h3>Limitations</h3>
<p>Transistors like the RFP30N06LE are really great for controlling high-power devices from your arduino, but they do have some limitations. This current configuration is only useful for switching DC current, so don't try this with an AC source, also MOSFETS have both a voltage and an amperage/current limitation. The RFP30N06LE can handle switching up to 60V, and the amperage is limited to 30A (with heat sink and proper wiring). Anything over a few amps, especially when the current is constant (like in a motor) and not short pulses, I would recommend using a heat-sink. I usually just solder a bent pice of metal to the back, just something to help dissipate the heat. Just note, if you are using more than one of the RFP30N06LEs, you can not solder them to the same heat-sink as the back is connected to the drain of the MOSFET, not the source. If you need to switch AC, I would look at using a relay instead.</p>
<h3>Fade it!</h3>
<p>You know the PWM outputs on your Arduino? Yeah, the thing that allows you to <strong>analogWrite(pin, value)</strong>. Well, PWM is not actually an analog output. The Arduino is actually pulsing (very quickly) between 0 and 5v so that the average voltage is somewhere in between 0 and 5. Because of this, the PWM can be extended through the transistor (the transistor can only turn on or off, but can do so very quickly) allowing us to fade lights or control the speed of a motor just like if they were connected directly to the Arduino. All you need to do in order to take advantage of this is make sure the MOSFET's gate is connected to a PWM pin.
</p></div>
<h3>Code</h3>
<p>You don't really need code for this, you just send a HIGH signal to the gate pin, and BAM... it works. But I threw this together for you so you can test it fading with the PWM- This code fades in a sin wave like the video below. (only useful for a motor or light obviously).</p>
<div class="codesnip-container">
<div class="codeHead">
<a class="copy" href="#">Copy Code</a>
</div>
<pre class="arduino codesnip" style="font-family:monospace;"><span class="co1">//////////////////////////////////////////////////////////////////</span>
<span class="co1">//©2011 bildr</span>
<span class="co1">//Released under the MIT License - Please reuse change and share</span>
<span class="co1">//Simple code to output a PWM sine wave signal on pin 9</span>
<span class="co1">//////////////////////////////////////////////////////////////////</span>

<span class="co2">#define fadePin 3</span>

<span class="kw4">void</span> setup<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="kw3">pinMode</span><span class="br0">(</span>fadePin<span class="sy0">,</span> <span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy0">;</span>  
<span class="br0">}</span>

<span class="kw4">void</span> loop<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>

  <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i<span class="sy0">&lt;</span><span class="nu0">360</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span><span class="br0">{</span>
    <span class="co1">//convert 0-360 angle to radian (needed for sin function)</span>
    <span class="kw4">float</span> rad <span class="sy0">=</span> DEG_TO_RAD <span class="sy0">*</span> i<span class="sy0">;</span>

    <span class="co1">//calculate sin of angle as number between 0 and 255</span>
    <span class="kw4">int</span> sinOut <span class="sy0">=</span> <span class="kw3">constrain</span><span class="br0">(</span><span class="br0">(</span><span class="kw3">sin</span><span class="br0">(</span>rad<span class="br0">)</span> <span class="sy0">*</span> 128<span class="br0">)</span> <span class="sy0">+</span> 128<span class="sy0">,</span> 0<span class="sy0">,</span> 255<span class="br0">)</span><span class="sy0">;</span> 

    <span class="kw3">analogWrite</span><span class="br0">(</span>fadePin<span class="sy0">,</span> sinOut<span class="br0">)</span><span class="sy0">;</span>

    <span class="kw3">delay</span><span class="br0">(</span>15<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>


<span class="br0">}</span></pre>
<div class="codeFoot">
				Unless otherwise stated, this code is released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> - Please use, change and share it.
			</div>
</div>
<h3>Video</h3>
<p>This video is showing the capabilities of PWM with the RFP30N06LE.  The light, though it looks like a standard house light, is actually a <a href="http://www.amazon.com/15-Watt-Frosted-Appliance-Ceiling/dp/B0042F8HLS">15W 12V DC light</a>.</p>
<p><iframe frameborder="0" height="534" src="http://player.vimeo.com/video/4402701?byline=0&amp;portrait=0" width="949"></iframe></p>
</div>
<div id="attribution">
<p>Article taken from <a href="http://bildr.org/rfp30n06le-arduino">bildr.org</a> with minor changes - <i>I am the original author of this content</i></p>
<div id="attributionIcons">
<div class="ccIcon cc"></div>
<div class="ccIcon sa"></div>
<div class="ccIcon attribution"></div>
<div id="attributionText">
<a href="https://creativecommons.org/licenses/by-sa/3.0/">Content available under:<br/>Attribution-Share Alike 3.0 Unported</a>
</div>
</div>
</div>
</div></div></div></body></html>