<!DOCTYPE html >

<html lang="en">
<head>
<meta charset="utf-8"/>
<link href="style/main.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.0/mootools-yui-compressed.js" type="text/javascript"></script>
<script type="text/javascript">
	
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	
	ga('create', 'UA-4050921-11', 'auto');
	ga('send', 'pageview');
	
	function nospam(user,domain) { window.location = "mailto:" + user + "@" + domain; }
		
		
	window.addEvent('domready', function(){

		$$('.codeHead .copy').addEvent('click', function(event) {
			this.highlight();
			event.stop();
			
			var code = this.getParent('.codesnip-container').getElement('.codesnip');
			
			if (code.select) {
				code.select();
			}else if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(code);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(code);
				window.getSelection().addRange(range);
			}
			
			
			try {
				var successful = document.execCommand('copy');
				var msg = successful ? 'successful' : 'unsuccessful';
				console.log('Copying text command was ' + msg);
			} catch (err) {
				console.log('Oops, unable to copy');
			}
		});
	
	});
	</script>
<!--
	
	Icon Set:	IcoMoon - Free -- http://keyamoon.com/icomoon/
	License:	CC BY-SA 3.0 -- http://creativecommons.org/licenses/by-sa/3.0/
	
	
	Icon Set:	Broccolidry -- http://dribbble.com/shots/587469-Free-16px-Broccolidryiconsaniconsetitisfullof-icons
	License:	Aribitrary -- http://licence.visualidiot.com/
	
	-->
<title>Adam meyer | Arduino</title>
</head>
<body>
<div id="headerWrapper">
<div id="header">
<h1><a href="http://adam-meyer.com">Adam meyer</a></h1>
<h2>Design + Code</h2>
<div id="topNav">
<a href="../about.html" id="aboutLink">About</a>
<a href="../resume.pdf">Resume</a>
<a href="../index.html">Portfolio</a>
<a href="index.html">Arduino Articles</a>
<span id="contactLink"><span onclick="javascript:nospam('sternmeyer','gmail.com');">Contact</span>
<div id="contactLinks">
<a class="icon-twitter" href="http://twitter.com/sternmeyer" title="twitter"></a>
<a class="icon-linkedin" href="http://www.linkedin.com/pub/adam-meyer/20/7a/850/" title="linked in"></a>
<a class="icon-dribbble" href="http://dribbble.com/ameyer" title="dribbble"></a>
<a class="icon-github" href="https://github.com/ameyer" title="github"></a>
<a class="icon-instagram" href="http://instagram.com/sternmeyer" title="instagram"></a>
<a class="icon-envelope2" href="mailto:sternmeyer@gmail.com" title="email"></a>
</div>
</span>
</div>
</div>
</div>
<div id="articleWrapper">
<div class="content">
<div class="post"><h2>Controlling a ton of servos - TLC5940 + Arduino</h2>
<div class="postContent">
<p><img class="noFrame" src="images/2012/01/TLC5940.jpg"/></p>
<div class="columnBody">
<div class="leftColumn">
<p>This is something we have been asked a lot about. How do I control a ton of Servo motors with my arduino? Well... using the TLC5940 is one way. And this <a href="http://www.sparkfun.com/products/10616">nice break outboard</a> from <a href="http://www.sparkfun.com/">sparkfun</a> makes connecting a ton of servos easy. The output pins on the board are all setup and spaced to allow you to just solder some male headers to it and plugin some servo cables.</p>
<h4>Why Do I need something special to control them?</h4>
<p>First off, if you don't know why something special is needed to control extra servos, let's go over a few basic things. A simple RC Servo (most <a href="http://www.sparkfun.com/search/results?term=servo&amp;what=products">smaller servos</a> in the sub $20 range) is a DC motor that knows its rotation position, and is most often limited to moving 180 degrees. You can instruct one of these servos to move to a specific degree (0-180) using PWM, Pulse Width Modulation. (Seriously, click the link to get a better visual understanding of what it is). On the arduino you usually think of this as analogWrite. Well, because there are only a few PWM pins on your arduino, if you want to control more servos than you have PWM pins, you need something like the TLC5940.</p>
<p>You can think of the TLC5940 as PWM pin multiplier because it needs a few PWM pins to operate correctly, but it gives you back a bunch more. If you were wondering, no, it can't add PWM capabilities to a controller that has no PWM pins.</p>
<h3>Hooking it up</h3>
<p>Hooking the TLC5940 up to your arduino is a little more complicated than most, but if you follow the diagram, you will be all set.</p>
<p>The power supply isn't always necessary, and you could connect the VCC pin to the 5V pin on your Arduino. But, if you plan on moving more than a couple of the Servos at a time, you will need an extra power supply, and yes, it must be 5V (and remember to connect the external supply ground to the arduino's ground as shown in the illustration). If you don't use a power supply, and you use too much power by moving too many of the servos at a time, you can cause the Arduino to restart due to power failure, and you will just get a bunch of twitching servos.</p>
<h4>chaining them together</h4>
<p>If you need more PWM/Servo connections, you can chain the TLC5940s together. Just connect another board's input pins to the output pins of the first and you are good to go. </p>
</div>
<div class="rightColumn">
<p><a href="images/2012/02/Tlc5940_arduino_hookup2.png"><img alt="" class="alignleft size-medium wp-image-1968" height="671" src="images/2012/02/Tlc5940_arduino_hookup2-400x671.png" title="Tlc5940_arduino_hookup2" width="400"/></a></p>
</div>
</div>
<p><img class="noFrame" src="images/2012/02/TLC5940_chain-950x129.png"/></p>
<div class="wideBody">
<h3>Code</h3>
<p>The code for this board is a bit on the complex side, so it uses <a href="http://code.google.com/p/tlc5940arduino/">a library</a> to make your life easier. Im going to do something a little unordinary here. <strong style="color: red;">The library is just a little too big to work well with our code delivery system. But you can <a href="http://code.google.com/p/tlc5940arduino/downloads/detail?name=Tlc5940_r014_2.zip&amp;can=2&amp;q= " style="color: darkred;">download the library here (zip file)</a></strong>.
</p></div>
<div class="columnBody">
<div class="leftColumn">
<p>To make this code work, <strong>before you load the code, or even open the Arduino program</strong>, you will need to place the downloaded "Tlc5940" folder (see above for link) into your Arduino Library. If you don’t know where your libraries folder is by default, Look to the right.
</p></div>
<div class="rightColumn">
<h3>Default Library Folder Location</h3>
<p><span style="font-size: 10px; line-height:12px;"><strong>On your Mac:</strong>: In (home directory)/Documents/Arduino/libraries<br/>
<strong>On your PC:</strong>: My Documents -&gt; Arduino -&gt; libraries<br/>
<strong>On your Linux box:</strong>: (home directory)/sketchbook/libraries<br/>
</span></p>
</div>
</div>
<div class="codesnip-container">
<div class="codeHead">
<a class="copy" href="#">Copy Code</a>
</div>
<pre class="arduino codesnip" style="font-family:monospace;"><span class="co1">//From the bildr article: http://bildr.org/2012/03/servos-tlc5940-arduino</span>
<span class="co1">//Requires the Tlc5940 library. http://code.google.com/p/tlc5940arduino/downloads/list</span>

<span class="co2">#include "Tlc5940.h"</span>
<span class="co2">#include "tlc_servos.h"</span>

<span class="kw4">int</span> numberOfServos <span class="sy0">=</span> <span class="nu0">9</span><span class="sy0">;</span> <span class="co1">//how many servos on the chain?</span>


<span class="kw4">void</span> setup<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  tlc_initServos<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>  <span class="co1">// Note: this will drop the PWM freqency down to 50Hz.</span>
<span class="br0">}</span>

<span class="kw4">void</span> loop<span class="br0">(</span><span class="br0">)</span><span class="br0">{</span>
  <span class="co1">//loop through all the servos and move one at a time to 180º</span>
  <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i<span class="sy0">&lt;</span>numberOfServos<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span><span class="br0">{</span>

    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> angle <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> angle <span class="sy0">&lt;</span> <span class="nu0">180</span><span class="sy0">;</span> angle<span class="sy0">+=</span> 10<span class="br0">)</span> <span class="br0">{</span>
      tlc_setServo<span class="br0">(</span>i<span class="sy0">,</span> angle<span class="br0">)</span><span class="sy0">;</span>
      Tlc.<span class="me1">update</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw3">delay</span><span class="br0">(</span>20<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>

    <span class="kw3">delay</span><span class="br0">(</span>200<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>

  <span class="co1">//loop through all the servos and move one at a time to 0º</span>
  <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i<span class="sy0">&lt;</span>numberOfServos<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span><span class="br0">{</span>

    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> angle <span class="sy0">=</span> <span class="nu0">180</span><span class="sy0">;</span> angle <span class="sy0">&gt;=</span> <span class="nu0">0</span><span class="sy0">;</span> angle<span class="sy0">-=</span> 10<span class="br0">)</span> <span class="br0">{</span>
      tlc_setServo<span class="br0">(</span>i<span class="sy0">,</span> angle<span class="br0">)</span><span class="sy0">;</span>
      Tlc.<span class="me1">update</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw3">delay</span><span class="br0">(</span>20<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>

    <span class="kw3">delay</span><span class="br0">(</span>200<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>



<span class="br0">}</span></pre>
<div class="codeFoot">
				Unless otherwise stated, this code is released under the <a href="http://www.opensource.org/licenses/mit-license.php">MIT License</a> - Please use, change and share it.
			</div>
</div>
<h3>Video</h3>
<p><iframe allowfullscreen="" frameborder="0" height="534" mozallowfullscreen="" src="http://player.vimeo.com/video/38274663?portrait=0" webkitallowfullscreen="" width="950"></iframe></p>
</div>
<div id="attribution">
<p>Article taken from <a href="http://bildr.org/servos-tlc5940-arduino">bildr.org</a> with minor changes - <i>I am the original author of this content</i></p>
<div id="attributionIcons">
<div class="ccIcon cc"></div>
<div class="ccIcon sa"></div>
<div class="ccIcon attribution"></div>
<div id="attributionText">
<a href="https://creativecommons.org/licenses/by-sa/3.0/">Content available under:<br/>Attribution-Share Alike 3.0 Unported</a>
</div>
</div>
</div>
</div></div></div></body></html>