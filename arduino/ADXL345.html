<!DOCTYPE html >

<html lang="en">
<head>
<meta charset="utf-8"/>
<link href="style/main.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.0/mootools-yui-compressed.js" type="text/javascript"></script>
<script type="text/javascript">
	
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	
	ga('create', 'UA-4050921-11', 'auto');
	ga('send', 'pageview');
	
	function nospam(user,domain) { window.location = "mailto:" + user + "@" + domain; }
		
		
	window.addEvent('domready', function(){

		$$('.codeHead .copy').addEvent('click', function(event) {
			this.highlight();
			event.stop();
			
			var code = this.getParent('.codesnip-container').getElement('.codesnip');
			
			if (code.select) {
				code.select();
			}else if (document.selection) {
				var range = document.body.createTextRange();
				range.moveToElementText(code);
				range.select();
			} else if (window.getSelection) {
				var range = document.createRange();
				range.selectNode(code);
				window.getSelection().addRange(range);
			}
			
			
			try {
				var successful = document.execCommand('copy');
				var msg = successful ? 'successful' : 'unsuccessful';
				console.log('Copying text command was ' + msg);
			} catch (err) {
				console.log('Oops, unable to copy');
			}
		});
	
	});
	</script>
<!--
	
	Icon Set:	IcoMoon - Free -- http://keyamoon.com/icomoon/
	License:	CC BY-SA 3.0 -- http://creativecommons.org/licenses/by-sa/3.0/
	
	
	Icon Set:	Broccolidry -- http://dribbble.com/shots/587469-Free-16px-Broccolidryiconsaniconsetitisfullof-icons
	License:	Aribitrary -- http://licence.visualidiot.com/
	
	-->
<title>Adam meyer | Arduino</title>
</head>
<body>
<div id="headerWrapper">
<div id="header">
<h1><a href="http://adam-meyer.com">Adam meyer</a></h1>
<h2>Design + Code</h2>
<div id="topNav">
<a href="../about.html" id="aboutLink">About</a>
<a href="../resume.pdf">Resume</a>
<a href="../index.html">Portfolio</a>
<a href="index.html">Arduino Articles</a>
<span id="contactLink"><span onclick="javascript:nospam('sternmeyer','gmail.com');">Contact</span>
<div id="contactLinks">
<a class="icon-twitter" href="http://twitter.com/sternmeyer" title="twitter"></a>
<a class="icon-linkedin" href="http://www.linkedin.com/pub/adam-meyer/20/7a/850/" title="linked in"></a>
<a class="icon-dribbble" href="http://dribbble.com/ameyer" title="dribbble"></a>
<a class="icon-github" href="https://github.com/ameyer" title="github"></a>
<a class="icon-instagram" href="http://instagram.com/sternmeyer" title="instagram"></a>
<a class="icon-envelope2" href="mailto:sternmeyer@gmail.com" title="email"></a>
</div>
</span>
</div>
</div>
</div>
<div id="articleWrapper">
<div class="content">
<div class="post"><h2>Tap, Tap, Drop. ADXL345 Accelerometer + Arduino</h2>
<div class="postContent">
<p><img class="noFrame" src="images/2011/02/adxl345.jpg"/></p>
<div class="wideBody">
You know accelerometers right? Yeah... the things that tell your phone how it is orientated. But, believe it or not accelerometers are best suited for something other than sensing orientation.  <strong>Excuse my oversimplification here, but this is going to help those who don't know what's going on.</strong> Accelerometers for all intents and purposes sense movement, so because gravity is pulling on the object it senses that and we can then determine orientation. Well... many actions like walking, throwing or jumping have particular movements associated with them, and a profile can be designed to recognize these movements. This is how your wii-mote can tell if your are bowling and not throwing, and your high-end pedometer knows the difference between running and walking. But we mortals often lack the insane math skills needed to write these movement profiles, and so we often just use our accelerometers as orientation sensors. BUT!!! What if your accelerometer did the heavy lifting for you? Well the ADXL345 does just that. It is able to sense taps, double taps, free-fall, activity and inactivity all by just configuring some parameters. Im using the <a href="http://www.sparkfun.com/products/9836">ADXL345 breakout board from sparkfun</a>.
<p>Out of the box, the ADXL345 is an I2C 3-axis accelerometer with user selectable sensitivity and 10-13 bit resolution (depending on sensitivity). And... It is pretty decent all around, but were not really going to spend much time talking about boring stuff today. Today, we are talking about getting the special features of the ADXL345 up and running. (tap, double tap, free fall, activity and inactivity)</p>
<p>These special detection features have the ability to trigger 2 interrupt pins, making the pin go HIGH the moment one of the events is sensed. You can select what events to watch for, and what interupt pin to trigger when it is sensed (I had issues with INT2, it would not reset). You can take these interrupt pins and connect them to your Arduino to trigger an interrupt. An interrupt, when sensed on the Arduino, pauses the system instantly, even if it is in the middle of something, and responds to that interrupt how ever you have it setup before returning to the normal code. Like a police officer coming down the street with its lights on... Even if you have a green light, you stop and let them go. But using interrupts is a little beyond the scope of this article, so we are going to just keep checking for these actions in code and respond to them when we see them.
</p></div>
<div class="columnBody">
<div class="leftColumn">
<h3>Hooking it up</h3>
<p>The ADXL345 supports both SPI and I2C, but we are just going to talk I2C here. I2C is a 2-wire serial connection, so you just need to connect the SDA (Data) and SCL (Clock) lines to your Arduino for communication. On your Arduino (everything but the mega) SDA is on analog pin 4, and SCL is on analog pin 5. On an arduino mega, SDA is digital 20, and SCL is digital 21.</p>
<p>Make sure both VCC and the CS pins on the sensor are connected to 3.3v. We connect CS to 3.3V to tell the sensor we will be using it as an I2C device, and not an SPI device.</p>
</div>
<div class="rightColumn">
<a href="images/2011/03/adxl345-arduino.png"><img class="noFrame" src="images/2011/03/adxl345-arduino-400x250.png" title="adxl345-arduino"/></a>
</div>
</div>
<h3>Code</h3>
<p>Again, because this project is made up of many files, I am using bildrâ€™s fancy bildrCode wrapper. All this example code will do for you now is output the name of the triggered action in the serial terminal. But I left the code in a state that should be pretty obvious how to extend it.</p>
<p>The special features require a lot of setup to get them working, but because this is bildr, we are going to start you off with working code, everything all setup, and spend a little bit explaining why certain things are how they are. To simplify everything in code, we will be using <a href="http://code.google.com/p/adxl345driver/">this Arduino library</a>. <strong>But I have made a few small changes</strong> to it to make this a little easier to do, and to make it work a little better with other libraries, so <strong>the new library files are included in the code below</strong>.</p>
<div class="columnBody">
<div class="leftColumn">
To make this code work, <strong>before you load the code, or even open the Arduino program</strong>, we need to place the "adxl345" folder into your Arduino Library. If you don't know where that is by default, Look to the right.
<p>Once the ADXL345 folder is in there, you can just go ahead and open ADXL345_Example.pde in your Arduino software, and upload it.</p>
<p>The parameters that are set in the code should get you going, but you will most likely find that your project requires something different. Read through the setup code, there are a lot of things that can be changed, from the force needed to activate "activity", the time before "inactivity" is triggered and the maximum length / minimum intensity of a tap. You can also completely turn off actions. I found that it was hard to trigger tap without triggering action, and double tap most often triggered tap as well. If you are up for it, the documentation on this chip is quite good, and explains a lot of the values in much greater detail (<a href="http://www.analog.com/static/imported-files/data_sheets/ADXL345.pdf">PDF</a>). </p>
</div>
<div class="rightColumn">
<h3>Default Library Folder Location</h3>
<p><span style="font-size: 10px; line-height:12px;"><strong>On your Mac:</strong>: In (home directory)/Documents/Arduino/libraries<br/>
<strong>On your PC:</strong>: My Documents -&gt; Arduino -&gt; libraries<br/>
<strong>On your Linux box:</strong>: (home directory)/sketchbook/libraries<br/>
</span></p>
<h3>Download</h3>
<p>If you click the download button to the right of "Arduino" you can download the whole thing as a zip, so you dont need to copy all the files.</p>
</div>
</div>
<div>
<div class="clear">
<script src="../github/ADXL345.js"></script>
</div>
</div>
<p></p>
<h3>Video</h3>
<p><iframe frameborder="0" height="534" src="http://player.vimeo.com/video/20956996?title=0&amp;byline=0&amp;portrait=0&amp;color=3399cc" width="949"></iframe></p>
<h3>Extending this</h3>
<p>Im sure you could come up with 101 ways to expand on this, but incase you need some help, here we go: What about a tap dance sensitive floor that caused lights to change with the rhythm of the dance? Shoes that shock you if you haven't walked in 5 min. Something as simple as a ball that you throw up and only lights up on its way down... Anything you could think of that needs or could incorporate (in)activity,  free-fall, or taps, you could find a way to use this to make it happen.</p>
</div>
<div id="attribution">
<p>Article taken from <a href="http://bildr.org/adxl345-arduino">bildr.org</a> with minor changes - <i>I am the original author of this content</i></p>
<div id="attributionIcons">
<div class="ccIcon cc"></div>
<div class="ccIcon sa"></div>
<div class="ccIcon attribution"></div>
<div id="attributionText">
<a href="https://creativecommons.org/licenses/by-sa/3.0/">Content available under:<br/>Attribution-Share Alike 3.0 Unported</a>
</div>
</div>
</div>
</div></div></div></body></html>